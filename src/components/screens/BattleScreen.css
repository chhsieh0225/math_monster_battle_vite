.scene-bg{
  position:absolute;
  inset:0;
  background-size:cover;
  background-position:center;
  image-rendering:auto;
  z-index:0;
  transform:translate3d(calc(var(--battle-parallax-x) * .16),calc(var(--battle-parallax-y) * .1),0) scale(1.04);
  will-change:transform;
}

@keyframes dropFloat{0%{transform:translateY(0) scale(0);opacity:0}20%{transform:translateY(-10px) scale(1.3);opacity:1}50%{transform:translateY(-30px) scale(1);opacity:1}100%{transform:translateY(-50px) scale(0.8);opacity:0}}
@keyframes effToastFadeOut{0%{opacity:1}100%{opacity:0}}
@keyframes chargeGlow{0%{filter:drop-shadow(0 0 4px rgba(255,200,0,0))}50%{filter:drop-shadow(0 0 16px rgba(255,200,0,0.8))}100%{filter:drop-shadow(0 0 4px rgba(255,200,0,0))}}
@keyframes enemyHit{
  0%{transform:translate(0,0) rotate(0deg)}
  12%{transform:translate(10px,-4px) rotate(-4deg)}
  24%{transform:translate(-8px,3px) rotate(5deg)}
  36%{transform:translate(5px,-2px) rotate(-3deg)}
  52%{transform:translate(-3px,1px) rotate(2deg)}
  100%{transform:translate(0,0) rotate(0deg)}
}
@keyframes playerHit{
  0%{transform:translate(0,0) scaleX(-1) rotate(0deg)}
  12%{transform:translate(-10px,4px) scaleX(-1) rotate(4deg)}
  24%{transform:translate(8px,-3px) scaleX(-1) rotate(-5deg)}
  36%{transform:translate(-5px,2px) scaleX(-1) rotate(3deg)}
  52%{transform:translate(3px,-1px) scaleX(-1) rotate(-2deg)}
  100%{transform:translate(0,0) scaleX(-1) rotate(0deg)}
}
@keyframes attackLunge{
  0%{transform:translate(0,0) scaleX(-1) scaleY(1) rotate(0deg)}
  18%{transform:translate(30px,-16px) scaleX(-1) scaleY(1.05) rotate(4deg)}
  36%{transform:translate(62px,-42px) scaleX(-1) scaleY(.94) rotate(8deg)}
  56%{transform:translate(62px,-42px) scaleX(-1) scaleY(.94) rotate(8deg)}
  76%{transform:translate(16px,-8px) scaleX(-1) scaleY(1.02) rotate(2deg)}
  100%{transform:translate(0,0) scaleX(-1) scaleY(1) rotate(0deg)}
}
@keyframes enemyAttackLunge{
  0%{transform:translate(0,0) scaleY(1) rotate(0deg)}
  18%{transform:translate(-28px,16px) scaleY(1.05) rotate(-4deg)}
  36%{transform:translate(-60px,40px) scaleY(.94) rotate(-8deg)}
  56%{transform:translate(-60px,40px) scaleY(.94) rotate(-8deg)}
  76%{transform:translate(-16px,8px) scaleY(1.02) rotate(-2deg)}
  100%{transform:translate(0,0) scaleY(1) rotate(0deg)}
}
@keyframes struggle{0%,100%{filter:brightness(1) saturate(1.3)}50%{filter:brightness(0.85) saturate(1.8) hue-rotate(-10deg)}}
@keyframes enemyDissolve{0%{opacity:1;filter:brightness(1);transform:translateY(0) scale(1)}30%{filter:brightness(2.5) saturate(0);transform:translateY(-6px) scale(1.06)}60%{opacity:.5;filter:brightness(1.8) saturate(0) blur(2px);transform:translateY(-12px) scale(1.02)}100%{opacity:0;filter:brightness(3) saturate(0) blur(6px);transform:translateY(-30px) scale(0.7)}}
@keyframes slideInBattle{0%{transform:translateX(120px);opacity:0}100%{transform:translateX(0);opacity:1}}
@keyframes slideInPlayer{0%{transform:translateX(-120px) scaleX(-1);opacity:0}100%{transform:translateX(0) scaleX(-1);opacity:1}}
@keyframes floatFlip{0%,100%{transform:translateY(0) scaleX(-1) scaleY(1)}50%{transform:translateY(-6px) scaleX(-1.02) scaleY(1.04)}}
@keyframes shadowPulse{0%,100%{transform:scaleX(1) scaleY(1);opacity:0.55}50%{transform:scaleX(0.82) scaleY(0.82);opacity:0.25}}
@keyframes bossShadowPulse{0%,100%{transform:scaleX(1) scaleY(1);opacity:0.55}25%{transform:scaleX(0.9) scaleY(0.9);opacity:0.35}50%{transform:scaleX(1) scaleY(1);opacity:0.5}75%{transform:scaleX(0.85) scaleY(0.85);opacity:0.3}}
@keyframes dodgeSlide{0%{transform:translateX(0) scaleX(-1)}25%{transform:translateX(-60px) translateY(-20px) scaleX(-1);opacity:0.2}55%{transform:translateX(-60px) translateY(-20px) scaleX(-1);opacity:0.2}100%{transform:translateX(0) scaleX(-1);opacity:1}}
@keyframes enemyGrassHit{
  0%{filter:brightness(1) hue-rotate(0deg);transform:translate(0,0) rotate(0deg)}
  15%{filter:brightness(1.8) hue-rotate(60deg);transform:translate(-6px,4px) rotate(4deg)}
  30%{filter:brightness(1.2) hue-rotate(30deg);transform:translate(5px,-3px) rotate(-5deg)}
  50%{filter:brightness(1.5) hue-rotate(50deg);transform:translate(-4px,2px) rotate(3deg)}
  70%{filter:brightness(1.2);transform:translate(2px,0) rotate(-2deg)}
  100%{filter:brightness(1) hue-rotate(0deg);transform:translate(0,0) rotate(0deg)}
}
@keyframes enemyFireHit{
  0%{filter:brightness(1);transform:translate(0,0) rotate(0deg)}
  20%{filter:brightness(2) hue-rotate(-20deg);transform:translate(8px,-2px) rotate(-4deg)}
  40%{filter:brightness(1.3);transform:translate(-5px,2px) rotate(5deg)}
  60%{filter:brightness(1.8) hue-rotate(-10deg);transform:translate(3px,-1px) rotate(-3deg)}
  100%{filter:brightness(1);transform:translate(0,0) rotate(0deg)}
}
@keyframes enemyElecHit{
  0%{filter:brightness(1);transform:translate(0,0) rotate(0deg)}
  10%{filter:brightness(3);transform:translate(4px,0) rotate(-4deg)}
  20%{filter:brightness(1.5);transform:translate(-4px,0) rotate(5deg)}
  30%{filter:brightness(2.5);transform:translate(3px,0) rotate(-3deg)}
  40%{filter:brightness(1);transform:translate(-3px,0) rotate(2deg)}
  50%{filter:brightness(2);transform:translate(0,0) rotate(0deg)}
  100%{filter:brightness(1);transform:translate(0,0) rotate(0deg)}
}
@keyframes enemyWaterHit{
  0%{filter:brightness(1);transform:translate(0,0) rotate(0deg)}
  20%{filter:brightness(1.5) saturate(2);transform:translate(9px,1px) rotate(-4deg)}
  40%{filter:brightness(1.2);transform:translate(-5px,-1px) rotate(5deg)}
  60%{filter:brightness(1.3) saturate(1.5);transform:translate(3px,0) rotate(-3deg)}
  100%{filter:brightness(1);transform:translate(0,0) rotate(0deg)}
}
@keyframes enemyDarkHit{
  0%{filter:brightness(1);transform:scale(1) rotate(0deg)}
  15%{filter:brightness(0.2);transform:scale(0.9) rotate(4deg)}
  30%{filter:brightness(3);transform:scale(1.15) rotate(-6deg)}
  50%{filter:brightness(0.5);transform:scale(0.95) rotate(4deg)}
  70%{filter:brightness(2);transform:scale(1.05) rotate(-3deg)}
  100%{filter:brightness(1);transform:scale(1) rotate(0deg)}
}
@keyframes bossFloat{0%,100%{transform:translateY(0) scale(1)}25%{transform:translateY(-3px) scale(1.02)}50%{transform:translateY(-1px) scale(1)}75%{transform:translateY(-4px) scale(1.01)}}
@keyframes bossShake{0%,100%{transform:translateX(0)}10%{transform:translateX(-2px)}20%{transform:translateX(2px)}30%{transform:translateX(-1px)}40%{transform:translateX(1px)}50%{transform:translateX(0)}}
@keyframes bossPulse{0%,100%{filter:drop-shadow(0 0 4px rgba(120,40,80,0.3))}50%{filter:drop-shadow(0 0 12px rgba(180,60,100,0.6)) drop-shadow(0 0 20px rgba(120,40,80,0.3))}}
@keyframes bossIntroFlashPulse{
  0%{opacity:0}
  12%{opacity:.95}
  28%{opacity:.08}
  100%{opacity:0}
}
@keyframes spriteBreath{
  0%,100%{transform:scaleX(1) scaleY(1)}
  50%{transform:scaleX(1.01) scaleY(1.03)}
}
@keyframes spriteBreathSub{
  0%,100%{transform:scaleX(1) scaleY(1)}
  50%{transform:scaleX(1.008) scaleY(1.022)}
}
@keyframes shieldPulse{0%{transform:scale(0);opacity:0}20%{transform:scale(1.15);opacity:1}50%{transform:scale(1);opacity:0.85}80%{transform:scale(1.05);opacity:0.9}100%{transform:scale(1.1);opacity:0}}
@keyframes shieldFlash{0%{background:transparent}15%{background:rgba(251,191,36,0.25)}40%{background:transparent}55%{background:rgba(251,191,36,0.15)}100%{background:transparent}}
@keyframes dodgeFlash{0%{background:transparent}15%{background:rgba(56,189,248,0.2)}40%{background:transparent}55%{background:rgba(56,189,248,0.12)}100%{background:transparent}}
@keyframes vineCounter{0%{transform:scale(0) rotate(-30deg);opacity:0}25%{transform:scale(1.1) rotate(5deg);opacity:1}60%{transform:scale(1) rotate(0deg);opacity:0.9}100%{transform:scale(0) rotate(30deg);opacity:0}}
@keyframes counterFlash{0%{background:transparent}15%{background:rgba(34,197,94,0.2)}40%{background:transparent}55%{background:rgba(34,197,94,0.12)}100%{background:transparent}}
@keyframes specDefReady{0%,100%{filter:drop-shadow(0 0 6px rgba(251,191,36,0.3))}50%{filter:drop-shadow(0 0 16px rgba(251,191,36,0.8))}}
@keyframes timerPulse{0%{opacity:1}50%{opacity:0.5}100%{opacity:1}}
@keyframes ultSyncFlash{0%{opacity:0}20%{opacity:.82}60%{opacity:.36}100%{opacity:0}}
@keyframes ultSyncCore{0%{transform:translate(50%,-32%) scale(.25);opacity:0}18%{opacity:.95}58%{transform:translate(50%,-32%) scale(1.05);opacity:.7}100%{transform:translate(50%,-32%) scale(1.34);opacity:0}}
@keyframes ultSyncRing{0%{transform:scale(.2);opacity:0}28%{opacity:.95}100%{transform:scale(1.2);opacity:0}}
@keyframes battleImpactCharge{0%{transform:translateY(0) scale(1);filter:brightness(1) saturate(1)}100%{transform:translateY(-3px) scale(1.018);filter:brightness(1.08) saturate(1.11)}}
@keyframes battleImpactShake{0%{transform:translate(0,0) scale(1.02)}16%{transform:translate(-5px,2px) scale(1.018)}32%{transform:translate(5px,-2px) scale(1.02)}48%{transform:translate(-4px,2px) scale(1.018)}64%{transform:translate(4px,-1px) scale(1.015)}100%{transform:translate(0,0) scale(1.01)}}
@keyframes battleImpactSettle{0%{transform:translate(0,0) scale(1.01);filter:brightness(1.06)}100%{transform:translate(0,0) scale(1);filter:brightness(1)}}
@keyframes battleHitPulse{0%{opacity:0;transform:scale(1.22)}35%{opacity:.82;transform:scale(1)}100%{opacity:0;transform:scale(.94)}}
@keyframes battleHitPulseShake{0%{opacity:0}22%{opacity:.88}68%{opacity:.34}100%{opacity:0}}

.battle-drop-toast{position:absolute;top:35%;right:30%;font-size:36px;pointer-events:none;z-index:88;animation:dropFloat 1.6s ease-out forwards;text-shadow:0 0 12px rgba(255,255,255,0.5)}

.battle-util-btn,.answer-btn{min-height:var(--touch-target)}

.battle-root{
  --battle-face-shift-main:-2px;
  --battle-face-tilt-main:-1.6deg;
  --battle-face-shift-sub:-1px;
  --battle-face-tilt-sub:-1deg;
  isolation:isolate;
  height:100%;
  display:flex;
  flex-direction:column;
  position:relative;
  overflow:hidden;
  background:linear-gradient(180deg,#020617 0%,#0b1220 100%);
  cursor:default;
}
.battle-root-advance{cursor:pointer}
.battle-hit-react-layer{
  position:absolute;
  inset:0;
  z-index:66;
  pointer-events:none;
  opacity:0;
  mix-blend-mode:screen;
  background:radial-gradient(circle at 50% 45%,rgba(255,255,255,.18),rgba(251,113,133,.12) 26%,rgba(30,41,59,0) 72%);
}
.battle-hit-react-layer.is-ult{
  mix-blend-mode:hard-light;
  background:radial-gradient(circle at 50% 45%,rgba(255,228,164,.24),rgba(251,146,60,.2) 24%,rgba(127,29,29,.16) 42%,rgba(2,6,23,0) 74%);
}
.battle-hit-react-layer.is-charge{animation:battleHitPulse .16s ease-out both}
.battle-hit-react-layer.is-freeze{opacity:.42}
.battle-hit-react-layer.is-shake{animation:battleHitPulseShake .22s ease both}
.battle-hit-react-layer.is-settle{animation:battleHitPulse .2s ease-out reverse both}

.battle-root .battle-arena{
  will-change:transform,filter;
  transform-origin:center 48%;
}
.battle-root.battle-impact-charge .battle-arena{animation:battleImpactCharge .14s cubic-bezier(.19,.74,.22,1) both}
.battle-root.battle-impact-freeze .battle-arena{
  transform:translateY(-3px) scale(1.018);
  filter:brightness(1.12) saturate(1.14);
}
.battle-root.battle-impact-freeze .battle-sprite-enemy-main,
.battle-root.battle-impact-freeze .battle-sprite-player-main,
.battle-root.battle-impact-freeze .battle-sprite-enemy-sub,
.battle-root.battle-impact-freeze .battle-sprite-player-sub,
.battle-root.battle-impact-freeze .battle-sprite-core-main,
.battle-root.battle-impact-freeze .battle-sprite-core-sub,
.battle-root.battle-impact-freeze .battle-sprite-enemy-shadow,
.battle-root.battle-impact-freeze .battle-sprite-player-shadow{animation-play-state:paused!important}
.battle-root.battle-impact-shake .battle-arena{animation:battleImpactShake .24s steps(2,end) both}
.battle-root.battle-impact-shake .battle-info-enemy,
.battle-root.battle-impact-shake .battle-info-player{transform:translateY(-2px)}
.battle-root.battle-impact-settle .battle-arena{animation:battleImpactSettle .2s ease-out both}
.battle-root.low-perf .battle-hit-react-layer{display:none}
.battle-root.low-perf{
  --battle-face-shift-main:0px;
  --battle-face-tilt-main:0deg;
  --battle-face-shift-sub:0px;
  --battle-face-tilt-sub:0deg;
}
.battle-root.low-perf.battle-impact-charge .battle-arena,
.battle-root.low-perf.battle-impact-shake .battle-arena,
.battle-root.low-perf.battle-impact-settle .battle-arena{
  animation:none!important;
  transform:none!important;
  filter:none!important;
}

.battle-loading-wrap{
  width:100%;
  min-height:100vh;
  min-height:100dvh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  background:radial-gradient(circle at 50% 18%,rgba(15,23,42,.95),#020617 70%);
  color:#fff;
}
.battle-loading-icon{
  font-size:52px;
  margin-bottom:12px;
  animation:float 1.1s ease-in-out infinite;
}
.battle-loading-text{
  font-size:15px;
  color:rgba(226,232,240,.88);
}

.battle-arena{
  --battle-parallax-x:0px;
  --battle-parallax-y:0px;
  flex:1;
  position:relative;
  min-height:0;
  background:#111;
  transition:background 1s ease;
}
.battle-scene-sky{
  position:absolute;
  inset:0;
  background:var(--scene-sky,#0f172a);
  opacity:.25;
  z-index:1;
  transition:background 1s ease;
  transform:translate3d(calc(var(--battle-parallax-x) * .22),calc(var(--battle-parallax-y) * .14),0);
  will-change:transform;
}
.battle-scene-ground{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  height:45%;
  background:var(--scene-ground,#1f2937);
  transition:background 1s ease;
  z-index:2;
  transform:translate3d(calc(var(--battle-parallax-x) * .34),calc(var(--battle-parallax-y) * .2),0);
  will-change:transform;
}
.battle-scene-platform-top{
  position:absolute;
  right:5%;
  top:8%;
  width:55%;
  height:12px;
  background:var(--scene-platform-top,rgba(255,255,255,.2));
  border-radius:50%;
  filter:blur(2px);
  z-index:3;
  transform:translate3d(calc(var(--battle-parallax-x) * .48),calc(var(--battle-parallax-y) * .26),0);
  will-change:transform;
}
.battle-scene-platform-bottom{
  position:absolute;
  left:2%;
  bottom:12%;
  width:50%;
  height:10px;
  background:var(--scene-platform-bottom,rgba(255,255,255,.2));
  border-radius:50%;
  filter:blur(2px);
  z-index:3;
  transform:translate3d(calc(var(--battle-parallax-x) * .56),calc(var(--battle-parallax-y) * .3),0);
  will-change:transform;
}
.battle-scene-deco{
  position:absolute;
  inset:0;
  z-index:4;
  pointer-events:none;
  transform:translate3d(calc(var(--battle-parallax-x) * .72),calc(var(--battle-parallax-y) * .42),0);
  will-change:transform;
}
.battle-weather-layer{
  position:absolute;
  inset:0;
  overflow:hidden;
  pointer-events:none;
  z-index:5;
  transform:translate3d(calc(var(--battle-parallax-x) * .84),calc(var(--battle-parallax-y) * .5),0);
  will-change:transform;
}
.battle-weather-layer.weather-rain,
.battle-weather-layer.weather-storm{
  mix-blend-mode:normal;
}
.battle-weather-layer.weather-fog{
  mix-blend-mode:normal;
}
.battle-weather-layer.weather-sun{
  mix-blend-mode:normal;
}
.battle-weather-rain-drop{
  position:absolute;
  top:-20%;
  left:var(--wx);
  width:4px;
  height:var(--wh);
  opacity:var(--wop);
  border-radius:3px;
  background:linear-gradient(180deg,rgba(148,163,184,0),rgba(191,219,254,.98));
  transform:rotate(13deg);
  filter:drop-shadow(0 0 3px rgba(191,219,254,.55));
  animation:weatherRainFall var(--wd) linear var(--wdelay) infinite;
}
.battle-weather-snow-flake{
  position:absolute;
  top:-8%;
  left:var(--wx);
  width:var(--ws);
  height:var(--ws);
  opacity:var(--wop);
  border-radius:50%;
  background:radial-gradient(circle,rgba(255,255,255,.98) 0%,rgba(226,232,240,.6) 50%,rgba(148,163,184,0) 100%);
  filter:drop-shadow(0 0 3px rgba(255,255,255,.6));
  animation:weatherSnowFall var(--wd) linear var(--wdelay) infinite;
}
.battle-weather-fog-band{
  position:absolute;
  top:var(--wtop);
  left:var(--wleft);
  width:var(--ww);
  height:var(--wh);
  opacity:var(--wop);
  border-radius:999px;
  filter:blur(10px);
  background:linear-gradient(90deg,rgba(226,232,240,.28),rgba(226,232,240,.58),rgba(226,232,240,.22));
  animation:weatherFogDrift var(--wd) ease-in-out var(--wdelay) infinite;
}
.battle-weather-dust-haze{
  position:absolute;
  inset:0;
  background:linear-gradient(180deg,rgba(234,179,8,.1),rgba(120,53,15,.18) 55%,rgba(120,53,15,.28));
  opacity:.6;
}
.battle-weather-dust-dot{
  position:absolute;
  top:var(--wtop);
  left:-5%;
  width:var(--ws);
  height:var(--ws);
  border-radius:50%;
  opacity:var(--wop);
  background:radial-gradient(circle,rgba(245,158,11,.92),rgba(146,64,14,.35) 68%,rgba(0,0,0,0) 100%);
  filter:drop-shadow(0 0 2px rgba(245,158,11,.3));
  animation:weatherDustFlow var(--wd) linear var(--wdelay) infinite;
}
.battle-weather-lightning{
  --wdelay:4s;
  position:absolute;
  inset:0;
  opacity:0;
  background:
    radial-gradient(circle at 65% 24%,rgba(255,255,255,.5),rgba(191,219,254,.18) 24%,rgba(15,23,42,0) 58%),
    linear-gradient(180deg,rgba(191,219,254,.08),rgba(15,23,42,0));
  animation:weatherLightning 7s linear var(--wdelay) infinite;
}
.battle-weather-lightning-secondary{
  animation-duration:9.5s;
}
.battle-weather-sun-glow{
  position:absolute;
  top:-22%;
  right:-8%;
  width:56%;
  height:64%;
  opacity:.62;
  border-radius:50%;
  background:
    radial-gradient(circle at 42% 52%,rgba(254,243,199,.92),rgba(251,191,36,.38) 32%,rgba(250,204,21,.14) 58%,rgba(255,255,255,0) 78%);
  filter:blur(1.5px);
  animation:weatherSunPulse 8.6s ease-in-out infinite;
}
.battle-weather-sun-ray{
  position:absolute;
  top:-26%;
  right:14%;
  width:34%;
  height:152%;
  opacity:.2;
  transform-origin:top right;
  background:linear-gradient(180deg,rgba(254,249,195,.68),rgba(253,224,71,.22) 38%,rgba(253,224,71,0) 80%);
  filter:blur(.8px);
}
.battle-weather-sun-ray-a{
  transform:rotate(19deg);
}
.battle-weather-sun-ray-b{
  right:20%;
  width:26%;
  opacity:.16;
  transform:rotate(25deg);
}
.battle-info-enemy{
  position:absolute;
  top:10px;
  left:10px;
  right:var(--battle-enemy-info-right,42%);
  z-index:10;
}
.battle-info-player{
  position:absolute;
  bottom:10px;
  right:10px;
  left:var(--battle-player-info-left,42%);
  z-index:10;
}
.battle-hp-focus{
  opacity:.62;
  transform:scale(.98);
  filter:saturate(.72);
  transition:opacity .2s ease,transform .2s ease,filter .2s ease;
}
.battle-hp-focus.is-active{
  opacity:1;
  transform:scale(1);
  filter:none;
}
.battle-hp-sub-row{margin-top:4px}
.battle-hp-card{
  background:rgba(0,0,0,.65);
  border-radius:12px;
  padding:8px 12px;
  backdrop-filter:blur(8px);
  border:1px solid rgba(255,255,255,.1);
}
.battle-hp-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:4px;
}
.battle-hp-label{
  font-size:14px;
  font-weight:800;
  color:#fff;
}
.battle-hp-value{
  font-size:12px;
  color:rgba(255,255,255,.5);
  font-family:'Press Start 2P',monospace;
}
.battle-hp-track{
  height:8px;
  background:rgba(255,255,255,.15);
  border-radius:4px;
  overflow:hidden;
}
.battle-hp-fill{
  width:var(--battle-hp-width,0%);
  height:100%;
  background:var(--battle-hp-color,#22c55e);
  border-radius:4px;
  transition:width .6s ease;
}
/* Venom poison HP bar flicker — only active during DOT tick */
.battle-hp-card.is-poisoned{
  animation:venomCardShake 0.3s ease-in-out 3;
}
.battle-hp-card.is-poisoned .battle-hp-fill{
  animation:venomFlicker 0.4s ease-in-out 3;
}
@keyframes venomFlicker{
  0%{filter:brightness(1) hue-rotate(0deg);}
  30%{filter:brightness(0.4) hue-rotate(90deg) saturate(3);}
  60%{filter:brightness(1.4) hue-rotate(0deg) saturate(1);}
  100%{filter:brightness(0.6) hue-rotate(60deg) saturate(2);}
}
@keyframes venomCardShake{
  0%,100%{transform:translateX(0);}
  25%{transform:translateX(-3px);}
  75%{transform:translateX(3px);}
}
.battle-hp-card.is-poisoned .battle-hp-label,
.battle-hp-card.is-poisoned .battle-hp-value{
  animation:venomTextPulse 0.4s ease-in-out 3;
}
@keyframes venomTextPulse{
  0%{color:inherit;text-shadow:none;}
  50%{color:#a855f7;text-shadow:0 0 6px rgba(168,85,247,0.8);}
  100%{color:inherit;text-shadow:none;}
}
.battle-xp-track{
  height:4px;
  background:rgba(255,255,255,.1);
  border-radius:2px;
  overflow:hidden;
  margin-top:4px;
}
.battle-xp-fill{
  width:var(--battle-xp-width,0%);
  height:100%;
  background:linear-gradient(90deg,#6366f1,#a855f7);
  border-radius:2px;
  transition:width .8s ease;
}
.battle-sprite-enemy-main{
  position:absolute;
  right:var(--enemy-main-right,10%);
  top:var(--enemy-main-top,26%);
  z-index:6;
  transform:scale(calc(var(--battle-enemy-main-scale,1) * var(--battle-device-scale,1))) rotate(-2.5deg);
  transform-origin:top right;
  animation:var(--enemy-main-anim,none);
}
.battle-sprite-enemy-sub{
  position:absolute;
  right:var(--enemy-sub-right,24%);
  top:var(--enemy-sub-top,23%);
  z-index:4;
  opacity:.78;
  transform:scale(calc(var(--enemy-sub-scale,.8) * var(--battle-enemy-sub-scale,1) * var(--battle-device-scale,1))) rotate(-2deg);
  transform-origin:top right;
  filter:saturate(.9);
  animation:var(--enemy-sub-anim,none);
}
.battle-sprite-enemy-shadow{
  position:absolute;
  right:var(--enemy-shadow-right);
  top:var(--enemy-shadow-top);
  width:var(--enemy-shadow-width);
  height:12px;
  background:radial-gradient(ellipse,rgba(0,0,0,.6),transparent);
  border-radius:50%;
  z-index:4;
  transform:scaleX(var(--battle-device-scale,1));
  transform-origin:center;
  animation:var(--enemy-shadow-anim,shadowPulse 3s ease-in-out infinite);
}
.battle-sprite-player-main{
  position:absolute;
  left:var(--player-main-left,6%);
  bottom:var(--player-main-bottom,14%);
  transform:scaleX(-1) scale(calc(var(--battle-player-main-scale,1) * var(--battle-device-scale,1))) rotate(-2.5deg);
  transform-origin:center bottom;
  z-index:var(--player-main-z,6);
  opacity:var(--player-main-opacity,1);
  filter:var(--player-main-filter,none);
  transition:left .35s ease, bottom .35s ease, filter .2s ease, opacity .3s ease, z-index 0s;
  animation:var(--player-main-anim,none);
}
.battle-sprite-player-sub{
  position:absolute;
  left:var(--player-sub-left,23%);
  bottom:var(--player-sub-bottom,15%);
  transform:scaleX(-1) scale(calc(var(--battle-player-sub-scale,1) * var(--battle-device-scale,1))) rotate(-2deg);
  transform-origin:center bottom;
  z-index:var(--player-sub-z,4);
  opacity:var(--player-sub-opacity,.84);
  filter:var(--player-sub-filter,none);
  transition:left .35s ease, bottom .35s ease, filter .2s ease, opacity .3s ease, z-index 0s;
  animation:var(--player-sub-anim,none);
}
.battle-sprite-player-shadow{
  position:absolute;
  left:var(--player-shadow-left);
  bottom:var(--player-shadow-bottom);
  width:var(--player-shadow-width);
  height:10px;
  background:radial-gradient(ellipse,rgba(0,0,0,.55),transparent);
  border-radius:50%;
  z-index:4;
  transform:scaleX(var(--battle-device-scale,1));
  transform-origin:center;
  animation:shadowPulse 3s ease-in-out infinite;
  transition:left .35s ease, bottom .35s ease;
}
.battle-sprite-core{
  will-change:transform,filter;
  transform-origin:50% 62%;
}
.battle-sprite-core-main{
  animation:spriteBreath 2.2s ease-in-out infinite;
}
.battle-sprite-core-sub{
  animation:spriteBreathSub 2.6s ease-in-out infinite;
}
.battle-root.low-perf .battle-sprite-core-main,
.battle-root.low-perf .battle-sprite-core-sub{
  animation:none;
}

.battle-def-fx{
  position:absolute;
  left:6%;
  bottom:14%;
  z-index:50;
  pointer-events:none;
}
.battle-def-fx-fire,.battle-def-fx-grass,.battle-def-fx-electric{width:160px;height:160px}
.battle-def-fx-water{width:130px;height:130px}
.battle-def-fx-light{width:170px;height:170px}

.battle-def-layer{
  position:absolute;
  inset:0;
  border-radius:50%;
}
.battle-def-layer-fire-core{
  background:radial-gradient(circle,rgba(251,191,36,.5),rgba(245,158,11,.15),transparent 70%);
  animation:shieldPulse 1.2s ease forwards;
}
.battle-def-layer-fire-ring{
  inset:-10px;
  border:3px solid rgba(251,191,36,.6);
  animation:shieldPulse 1.2s ease .1s forwards;
  opacity:0;
}
.battle-def-layer-water-ripple-1,.battle-def-layer-water-ripple-2,.battle-def-layer-water-ripple-3{
  background:radial-gradient(circle,rgba(56,189,248,.35),transparent 70%);
  animation:shieldPulse .8s ease forwards;
  opacity:0;
}
.battle-def-layer-water-ripple-2{animation-delay:.15s}
.battle-def-layer-water-ripple-3{animation-delay:.3s}
.battle-def-layer-grass-core{
  background:radial-gradient(circle,rgba(34,197,94,.45),rgba(22,163,74,.12),transparent 70%);
  animation:vineCounter 1.4s ease forwards;
}
.battle-def-layer-grass-ring{
  inset:-5px;
  border:3px solid rgba(34,197,94,.5);
  animation:vineCounter 1.4s ease .1s forwards;
  opacity:0;
}
.battle-def-layer-electric-core{
  background:radial-gradient(circle,rgba(251,191,36,.5),rgba(234,179,8,.15),transparent 70%);
  animation:shieldPulse 1.2s ease forwards;
}
.battle-def-layer-electric-ring{
  inset:-8px;
  border:3px solid rgba(251,191,36,.6);
  animation:shieldPulse 1.2s ease .1s forwards;
  opacity:0;
}
.battle-def-layer-light-core{
  background:radial-gradient(circle,rgba(245,158,11,.55),rgba(251,191,36,.2),transparent 70%);
  animation:shieldPulse 1.2s ease forwards;
}
.battle-def-layer-light-ring{
  inset:-8px;
  border:3px solid rgba(245,158,11,.6);
  animation:shieldPulse 1.2s ease .1s forwards;
  opacity:0;
}
.battle-def-layer-light-ring-outer{
  inset:-16px;
  border:2px solid rgba(251,191,36,.3);
  animation:shieldPulse 1.2s ease .2s forwards;
  opacity:0;
}

.battle-def-icon{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  animation:popIn .3s ease;
}
.battle-def-icon-fire,.battle-def-icon-electric,.battle-def-icon-light{font-size:48px}
.battle-def-icon-grass{font-size:44px}
.battle-def-icon-water{font-size:40px}
.battle-def-icon-fire,.battle-def-icon-electric{filter:drop-shadow(0 0 12px rgba(251,191,36,.8))}
.battle-def-icon-water{filter:drop-shadow(0 0 10px rgba(56,189,248,.8))}
.battle-def-icon-grass{filter:drop-shadow(0 0 10px rgba(34,197,94,.8))}
.battle-def-icon-light{filter:drop-shadow(0 0 14px rgba(245,158,11,.9))}

.battle-def-screen{
  position:absolute;
  inset:0;
  z-index:45;
  pointer-events:none;
}
.battle-def-screen-fire,.battle-def-screen-electric,.battle-def-screen-light{animation:shieldFlash .8s ease}
.battle-def-screen-water{animation:dodgeFlash .8s ease}
.battle-def-screen-grass{animation:counterFlash .8s ease}

.battle-eff-toast{
  position:absolute;
  top:15%;
  left:50%;
  transform:translateX(-50%);
  color:#fff;
  padding:7px 16px;
  border-radius:999px;
  font-size:13px;
  font-weight:800;
  z-index:220;
  pointer-events:none;
  animation:popIn .24s ease, effToastFadeOut .3s ease 1.2s forwards;
  letter-spacing:.4px;
  border:1px solid rgba(255,255,255,.24);
  backdrop-filter:blur(6px);
  text-shadow:0 1px 2px rgba(0,0,0,.45);
  max-width:min(88vw,420px);
  text-align:center;
  box-shadow:var(--battle-eff-shadow,0 8px 22px rgba(15,23,42,.42));
}
.battle-eff-toast-good{background:linear-gradient(135deg,rgba(21,128,61,.93),rgba(22,163,74,.9))}
.battle-eff-toast-bad{background:linear-gradient(135deg,rgba(71,85,105,.92),rgba(51,65,85,.92))}

.battle-ult-sync{
  --ult-sync-core-1:rgba(157,142,195,.78);
  --ult-sync-core-2:rgba(91,33,182,.46);
  --ult-sync-flash:rgba(2,6,23,.45);
  --ult-sync-ring:rgba(157,142,195,.55);
  --ult-sync-ring-soft:rgba(196,181,253,.36);
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:79;
}
.battle-attack-fx-layer{
  position:absolute;
  inset:0;
  z-index:140;
  pointer-events:none;
  isolation:isolate;
}
/* Momentary dark vignette to boost effect contrast on bright scenes */
.battle-attack-fx-layer.fx-bright-scene::before{
  content:'';
  position:absolute;
  inset:0;
  background:radial-gradient(ellipse 80% 70% at 50% 50%,rgba(0,0,0,.18) 0%,rgba(0,0,0,.08) 40%,transparent 72%);
  pointer-events:none;
  animation:fxBrightDim .65s ease-out both;
  z-index:-1;
}
@keyframes fxBrightDim{
  0%{opacity:0}
  18%{opacity:1}
  70%{opacity:.85}
  100%{opacity:0}
}
/* Boost drop-shadow glow on bright scenes so warm FX pop */
.battle-attack-fx-layer.fx-bright-scene{
  filter:contrast(1.12) drop-shadow(0 0 2px rgba(0,0,0,.22));
}
.battle-ult-sync.is-fire{
  --ult-sync-core-1:rgba(251,146,60,.82);
  --ult-sync-core-2:rgba(157,23,77,.56);
  --ult-sync-flash:rgba(127,29,29,.46);
  --ult-sync-ring:rgba(251,191,36,.65);
}
.battle-ult-sync.is-water{
  --ult-sync-core-1:rgba(56,189,248,.72);
  --ult-sync-core-2:rgba(30,64,175,.44);
  --ult-sync-flash:rgba(2,132,199,.32);
  --ult-sync-ring:rgba(125,211,252,.55);
}
.battle-ult-sync.is-electric{
  --ult-sync-core-1:rgba(251,191,36,.76);
  --ult-sync-core-2:rgba(124,58,237,.4);
  --ult-sync-flash:rgba(202,138,4,.32);
  --ult-sync-ring:rgba(254,240,138,.55);
}
.battle-ult-sync.is-grass{
  --ult-sync-core-1:rgba(74,222,128,.82);
  --ult-sync-core-2:rgba(6,78,59,.54);
  --ult-sync-flash:rgba(22,163,74,.46);
  --ult-sync-ring:rgba(134,239,172,.62);
}
.battle-ult-sync.is-light{
  --ult-sync-core-1:rgba(251,191,36,.84);
  --ult-sync-core-2:rgba(147,51,234,.48);
  --ult-sync-flash:rgba(245,158,11,.42);
  --ult-sync-ring:rgba(254,240,138,.66);
}
.battle-ult-sync-flash{
  position:absolute;
  inset:0;
  background:radial-gradient(circle at calc(100% - var(--ult-sync-right)) var(--ult-sync-top),var(--ult-sync-flash),transparent 65%);
  animation:ultSyncFlash .75s ease both;
}
.battle-ult-sync-core{
  position:absolute;
  right:var(--ult-sync-right);
  top:var(--ult-sync-top);
  width:136px;
  height:136px;
  border-radius:50%;
  transform:translate(50%,-32%);
  background:radial-gradient(circle,var(--ult-sync-core-1),var(--ult-sync-core-2) 56%,transparent 78%);
  filter:blur(.2px);
  animation:ultSyncCore .86s cubic-bezier(.18,.72,.22,1) both;
}
.battle-ult-sync-ring{
  position:absolute;
  right:calc(var(--ult-sync-right) - 44px);
  top:calc(var(--ult-sync-top) - 26px);
  width:210px;
  height:108px;
  border-radius:50%;
  border:2px solid var(--ult-sync-ring);
  opacity:0;
  animation:ultSyncRing .88s ease .06s both;
}
.battle-ult-sync-ring-alt{
  border-color:var(--ult-sync-ring-soft);
  animation-delay:.14s;
}

.battle-level-toast{
  position:absolute;
  top:60px;
  left:50%;
  transform:translateX(-50%);
  background:linear-gradient(135deg,rgba(251,191,36,.9),rgba(245,158,11,.9));
  color:#fff;
  padding:6px 18px;
  border-radius:20px;
  font-size:13px;
  font-weight:700;
  z-index:200;
  animation:popIn .3s ease;
  box-shadow:0 4px 16px rgba(245,158,11,.4);
  white-space:nowrap;
}
.battle-collection-popup{
  position:absolute;
  top:126px;
  right:12px;
  z-index:250;
  width:220px;
  border-radius:14px;
  padding:10px 12px;
  color:#fff;
  background:linear-gradient(135deg,rgba(16,185,129,.9),rgba(59,130,246,.9));
  box-shadow:0 6px 24px rgba(14,116,144,.42);
  animation:popIn .35s ease,fadeSlide .45s ease reverse 3.6s forwards;
  pointer-events:none;
}
.battle-collection-popup-head{
  font-size:11px;
  font-weight:800;
  opacity:.84;
  margin-bottom:6px;
  letter-spacing:.2px;
}
.battle-collection-popup-body{
  display:flex;
  align-items:center;
  gap:8px;
}
.battle-collection-popup-icon{
  font-size:24px;
  line-height:1;
}
.battle-collection-popup-desc{
  font-size:12px;
  font-weight:600;
  line-height:1.35;
}

.battle-status-row{
  display:flex;
  gap:4px;
  margin-top:3px;
  flex-wrap:wrap;
}
.battle-status-chip{
  color:#fff;
  padding:2px 8px;
  border-radius:8px;
  font-size:11px;
  font-weight:700;
  animation:popIn .3s ease;
  letter-spacing:.1px;
}
.battle-status-chip.is-burn{background:rgba(239,68,68,.85)}
.battle-status-chip.is-freeze{background:rgba(56,189,248,.85)}
.battle-status-chip.is-paralyze{background:rgba(234,179,8,.85)}
.battle-status-chip.is-static{background:rgba(234,179,8,.85)}
.battle-status-chip.is-counter{background:rgba(99,102,241,.85)}
.battle-status-chip.is-counter-soft{background:rgba(99,102,241,.72)}
.battle-status-chip.is-boss{background:rgba(168,85,247,.85)}
.battle-status-chip.is-charge{background:rgba(251,191,36,.9);color:#000}
.battle-status-chip.is-curse{background:rgba(168,85,247,.85)}
.battle-status-chip-inline{display:inline-block;margin-top:3px}

.battle-top-right-stack{
  position:absolute;
  top:10px;
  right:10px;
  z-index:20;
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:4px;
  pointer-events:none;
}
.battle-pill{
  border-radius:14px;
  font-size:10px;
  font-weight:700;
  color:#fff;
  padding:3px 9px;
  animation:popIn .3s ease;
  white-space:nowrap;
}
.battle-pill.is-streak{background:linear-gradient(135deg,#f59e0b,#ef4444);font-size:11px}
.battle-pill.is-passive{
  background:rgba(99,102,241,.8);
  display:flex;
  align-items:center;
  gap:3px;
}
.battle-pill.is-timed{
  background:rgba(239,68,68,.7);
  backdrop-filter:blur(4px);
}
.battle-top-right-stack.low-perf .battle-pill.is-timed{backdrop-filter:none}
.battle-pill.is-diff-up{background:rgba(239,68,68,.7)}
.battle-pill.is-diff-down{background:rgba(56,189,248,.7)}

.battle-charge-meter{
  position:absolute;
  bottom:50px;
  left:10px;
  display:flex;
  align-items:center;
  gap:4px;
  z-index:20;
  background:rgba(0,0,0,.3);
  padding:3px 8px;
  border-radius:10px;
  backdrop-filter:blur(4px);
}
.battle-charge-meter.low-perf{backdrop-filter:none}
.battle-charge-dot{
  width:11px;
  height:11px;
  border-radius:6px;
  background:rgba(0,0,0,.15);
  border:2px solid rgba(255,255,255,.4);
  transition:all .3s;
}
.battle-charge-dot.is-on{background:#f59e0b}
.battle-charge-dot.is-glow{animation:chargeGlow 1.5s ease infinite}
.battle-charge-max{
  font-size:9px;
  color:#b45309;
  font-weight:700;
  margin-left:2px;
  animation:popIn .3s ease;
}

.battle-left-badge-stack{
  position:absolute;
  bottom:70px;
  left:10px;
  z-index:20;
  display:flex;
  flex-direction:column;
  align-items:flex-start;
  gap:4px;
}
.battle-pill.is-last-stand{
  background:linear-gradient(135deg,rgba(251,191,36,.9),rgba(245,158,11,.9));
  box-shadow:0 2px 12px rgba(251,191,36,.4);
  animation:popIn .3s ease,specDefReady 2s ease infinite;
  font-size:11px;
  padding:3px 10px;
}
.battle-pill.is-specdef{
  font-size:11px;
  padding:3px 10px;
  animation:popIn .3s ease,specDefReady 2s ease infinite;
}
.battle-pill-specdef-fire{
  background:linear-gradient(135deg,rgba(251,191,36,.9),rgba(245,158,11,.9));
  box-shadow:0 2px 12px rgba(251,191,36,.4);
}
.battle-pill-specdef-water{
  background:linear-gradient(135deg,rgba(56,189,248,.9),rgba(14,165,233,.9));
  box-shadow:0 2px 12px rgba(56,189,248,.4);
}
.battle-pill-specdef-electric{
  background:linear-gradient(135deg,rgba(251,191,36,.9),rgba(234,179,8,.9));
  box-shadow:0 2px 12px rgba(234,179,8,.4);
}
.battle-pill-specdef-light{
  background:linear-gradient(135deg,rgba(245,158,11,.9),rgba(217,119,6,.9));
  box-shadow:0 2px 12px rgba(245,158,11,.4);
}
.battle-pill-specdef-grass{
  background:linear-gradient(135deg,rgba(34,197,94,.9),rgba(22,163,74,.9));
  box-shadow:0 2px 12px rgba(34,197,94,.4);
}
.battle-boss-hint{
  position:absolute;
  top:40%;
  left:50%;
  transform:translateX(-50%);
  z-index:20;
  background:rgba(251,191,36,.95);
  color:#000;
  padding:6px 16px;
  border-radius:12px;
  font-size:14px;
  font-weight:800;
  animation:popIn .3s ease;
  box-shadow:0 4px 20px rgba(251,191,36,.6);
}

.battle-panel{
  background:linear-gradient(180deg,var(--battle-panel-top) 0%,var(--battle-panel-mid) 52%,var(--battle-panel-bottom) 100%);
  border-top:1px solid rgba(255,255,255,.13);
  box-shadow:0 -10px 24px rgba(2,6,23,.5);
  flex-shrink:0;
  position:relative;
}
.battle-panel.is-question{min-height:210px}
.battle-panel.is-normal{min-height:170px}

.battle-menu-wrap{padding:10px}
.battle-menu-hint{
  margin-bottom:8px;
  font-size:12px;
  font-weight:700;
  color:rgba(226,232,240,.78);
  letter-spacing:.2px;
}
.battle-menu-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.battle-item-row{
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:8px;
  flex-wrap:wrap;
}
.battle-item-btn{
  display:inline-flex;
  align-items:center;
  gap:6px;
  min-height:30px;
  border-radius:999px;
  border:1px solid rgba(56,189,248,.35);
  background:linear-gradient(135deg,rgba(14,116,144,.2),rgba(14,165,233,.1));
  color:#e0f2fe;
  font-size:11px;
  font-weight:700;
  padding:4px 10px;
  line-height:1.2;
  transition:transform .15s ease,opacity .15s ease,border-color .15s ease,background .15s ease;
}
.battle-item-btn:not(:disabled):hover{
  transform:translateY(-1px);
  border-color:rgba(125,211,252,.58);
  background:linear-gradient(135deg,rgba(14,116,144,.35),rgba(14,165,233,.16));
}
.battle-item-btn:disabled{
  opacity:.45;
  cursor:not-allowed;
}
.battle-item-btn-icon{font-size:13px;line-height:1}
.battle-item-btn-name{white-space:nowrap}
.battle-item-btn-count{
  font-family:'Press Start 2P',monospace;
  font-size:8px;
  color:#bae6fd;
}
.battle-item-note{
  font-size:10px;
  color:rgba(148,163,184,.88);
  letter-spacing:.2px;
}

.battle-menu-btn{
  min-height:88px;
  border-radius:12px;
  padding:10px;
  text-align:left;
  position:relative;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  gap:3px;
  transition:transform .15s ease,border-color .2s ease,filter .2s ease,opacity .2s ease;
  background:var(--move-bg,rgba(255,255,255,.08));
  border:2px solid var(--move-border,rgba(255,255,255,.15));
  opacity:var(--move-opacity,1);
  cursor:var(--move-cursor,pointer);
  animation:fadeSlide .3s ease var(--move-enter-delay,0s) both;
}
.battle-menu-btn:not(:disabled):hover{transform:translateY(-1px)}
.battle-menu-btn.is-locked{filter:saturate(.75)}

.move-sealed-mask{
  position:absolute;
  inset:0;
  background:rgba(76,29,149,.2);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:3;
  border-radius:12px;
}
.move-sealed-text{
  font-size:16px;
  font-weight:800;
  color:#e9d5ff;
  text-shadow:0 2px 8px rgba(0,0,0,.55);
}

.move-badge-stack{
  position:absolute;
  top:6px;
  right:6px;
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:3px;
  z-index:2;
}
.move-badge{
  font-size:9px;
  font-weight:800;
  padding:2px 6px;
  border-radius:999px;
  line-height:1;
  color:#fff;
  white-space:nowrap;
  box-shadow:0 1px 8px rgba(0,0,0,.25);
}
.move-badge-level{
  font-family:'Press Start 2P',monospace;
  font-size:9px;
  padding:3px 6px;
  background:var(--move-level-bg,#64748b);
}
.move-badge-level.cap{background:linear-gradient(135deg,#f59e0b,#dc2626)}
.move-badge-up{background:#16a34a}
.move-badge-down{background:#64748b}

.move-name-row{
  display:flex;
  align-items:center;
  gap:5px;
  margin-bottom:1px;
  min-height:22px;
  padding-right:74px;
}
.move-icon{font-size:20px;line-height:1}
.move-name{
  font-size:15px;
  font-weight:700;
  line-height:1.15;
  text-shadow:0 1px 2px rgba(0,0,0,.2);
  color:var(--move-name-color,#e2e8f0);
}
.move-desc-row{
  font-size:12px;
  line-height:1.24;
  color:var(--move-desc-color,#94a3b8);
  padding-right:6px;
  word-break:break-word;
}
.move-power{color:var(--move-power-color,inherit)}
.move-progress-track{
  height:3px;
  background:rgba(15,23,42,.45);
  border-radius:2px;
  margin-top:4px;
  overflow:hidden;
}
.move-progress-fill{
  height:100%;
  border-radius:2px;
  transition:width .3s;
  width:var(--move-progress-width,0%);
  background:var(--move-progress-color,#22c55e);
}

.battle-util-row{
  display:flex;
  justify-content:flex-end;
  gap:8px;
  margin-top:8px;
  flex-wrap:wrap;
}
.battle-util-btn{
  background:rgba(148,163,184,.08);
  border:1px solid rgba(148,163,184,.28);
  color:rgba(226,232,240,.92);
  font-size:11px;
  font-weight:700;
  padding:5px 10px;
  border-radius:999px;
  min-height:30px;
  line-height:1.2;
  transition:background .15s ease,border-color .15s ease,color .15s ease,transform .15s ease,opacity .15s ease;
}
.battle-util-btn:not(:disabled):hover{
  background:rgba(148,163,184,.16);
  border-color:rgba(203,213,225,.5);
  color:#fff;
}
.battle-util-btn:disabled{opacity:.55;cursor:not-allowed}
.battle-util-btn-danger{
  border-color:rgba(248,113,113,.32);
  color:#fecaca;
}
.battle-util-btn-danger:not(:disabled):hover{
  background:rgba(127,29,29,.25);
  border-color:rgba(248,113,113,.5);
  color:#fee2e2;
}

.battle-question-wrap{padding:10px 14px;animation:fadeSlide .25s ease}
.battle-question-head{
  display:flex;
  align-items:center;
  gap:6px;
  margin-bottom:8px;
  flex-wrap:wrap;
}
.battle-question-icon{font-size:18px}
.battle-question-title{font-size:16px;font-weight:700;color:#fff}
.battle-question-sub{font-size:13px;color:rgba(255,255,255,.6)}
.battle-question-note{font-size:12px;color:rgba(255,255,255,.42)}
.battle-question-card{
  background:rgba(255,255,255,.08);
  border-radius:12px;
  padding:10px 16px;
  text-align:center;
  margin-bottom:8px;
  border:1px solid rgba(255,255,255,.1);
  position:relative;
  overflow:hidden;
}
.battle-timer-bar{
  position:absolute;
  bottom:0;
  left:0;
  height:4px;
  background:var(--battle-timer-tone,#22c55e);
  width:var(--battle-timer-width,100%);
  border-radius:2px;
  transition:width .05s linear,background .3s;
  animation:var(--battle-timer-pulse,none);
}
.battle-timer-text{
  font-size:11px;
  font-weight:700;
  color:var(--battle-timer-text-tone,rgba(255,255,255,.4));
  margin-top:2px;
  font-family:'Press Start 2P',monospace;
  transition:color .3s;
}
.battle-question-type{font-size:10px;color:rgba(255,255,255,.35);margin-bottom:2px}
.battle-question-expression{font-size:36px;font-weight:900;color:#fff;letter-spacing:2px}
.battle-math-frac{
  display:inline-flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  vertical-align:middle;
  margin:0 .08em;
  min-width:1.25em;
  letter-spacing:0;
  line-height:1;
  font-variant-numeric:tabular-nums;
}
.battle-math-frac-top,
.battle-math-frac-bottom{
  display:block;
  line-height:1;
  font-size:.68em;
  padding:0 .1em;
  white-space:nowrap;
}
.battle-math-frac-line{
  display:block;
  width:100%;
  height:1.5px;
  background:currentColor;
  opacity:.95;
  margin:1px 0 2px;
}
.battle-answer-btn .battle-math-frac{
  font-size:.88em;
}
.battle-feedback .battle-math-frac{
  font-size:1em;
}
.battle-feedback-step-row .battle-math-frac{
  font-size:.92em;
}
.battle-feedback{
  text-align:center;
  margin-bottom:4px;
  font-size:16px;
  font-weight:700;
  animation:popIn .2s ease;
}
.battle-feedback.is-correct{color:#22c55e}
.battle-feedback.is-wrong{color:#ef4444}
.battle-feedback-steps{
  background:rgba(239,68,68,.08);
  border:1px solid rgba(239,68,68,.2);
  border-radius:10px;
  padding:8px 12px;
  margin-bottom:6px;
  animation:fadeIn .4s ease;
}
.battle-feedback-steps-title{
  font-size:11px;
  color:#fca5a5;
  font-weight:700;
  margin-bottom:4px;
}
.battle-feedback-step-row{
  font-size:13px;
  color:rgba(255,255,255,.8);
  font-weight:600;
  line-height:1.8;
  font-family:monospace;
}
.battle-feedback-step-index{
  color:#fca5a5;
  font-size:11px;
  margin-right:4px;
}
.battle-answer-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:7px;
}
.battle-answer-btn{
  border-radius:10px;
  padding:12px 8px;
  font-size:26px;
  font-weight:700;
  transition:all .2s;
  background:rgba(255,255,255,.08);
  border:2px solid rgba(255,255,255,.15);
  color:#fff;
}
.battle-answer-btn.is-correct{
  background:rgba(34,197,94,.2);
  border-color:#22c55e;
  color:#22c55e;
}
.battle-answer-btn.is-dim{
  background:rgba(255,255,255,.03);
  border-color:rgba(255,255,255,.08);
  color:rgba(255,255,255,.3);
}

.boss-cine-overlay{
  position:absolute;
  inset:0;
  z-index:8800;
  pointer-events:auto;
  overflow:hidden;
}
.boss-cine-blackout{
  position:absolute;
  inset:0;
  background:#000;
  opacity:1;
  transition:opacity .62s ease;
}
.boss-cine-flash{
  position:absolute;
  inset:-22%;
  opacity:0;
  pointer-events:none;
  background:radial-gradient(circle at 50% 38%,rgba(255,255,255,.96),rgba(255,255,255,.35) 18%,rgba(255,255,255,0) 58%);
  mix-blend-mode:screen;
}
.boss-cine-scene{
  position:absolute;
  inset:0;
  background-position:center;
  background-size:cover;
  opacity:0;
  filter:brightness(.2) saturate(.25) contrast(1.2);
  transform:scale(1.06);
  transition:opacity .8s ease, filter 1s ease, transform 1s ease;
}
.boss-cine-silhouette-wrap{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding-top:3%;
}
.boss-cine-silhouette{
  width:min(66vw,430px);
  height:min(52vh,320px);
  background-position:center;
  background-repeat:no-repeat;
  background-size:contain;
  opacity:0;
  transform:translateY(18px) scale(.9);
  filter:brightness(0) contrast(1.45) drop-shadow(0 20px 28px rgba(0,0,0,.92));
  transition:opacity .7s ease, transform .7s ease, filter .85s ease;
}
.boss-cine-text{
  position:absolute;
  left:50%;
  bottom:18%;
  transform:translateX(-50%);
  color:#f8fafc;
  font-weight:900;
  letter-spacing:.08em;
  font-size:clamp(18px,2.9vw,30px);
  text-shadow:0 2px 10px rgba(0,0,0,.9),0 0 16px rgba(248,250,252,.25);
  opacity:0;
  transition:opacity .45s ease;
}
.boss-cine-overlay.is-flash .boss-cine-flash{
  animation:bossIntroFlashPulse .24s ease-out 0s 1 both;
}
.boss-cine-overlay.is-reveal .boss-cine-blackout{
  opacity:.12;
}
.boss-cine-overlay.is-reveal .boss-cine-scene{
  opacity:1;
  transform:scale(1);
  filter:brightness(.78) saturate(.72) contrast(1.06);
}
.boss-cine-overlay.is-reveal .boss-cine-silhouette{
  opacity:.94;
  transform:translateY(0) scale(1);
}
.boss-cine-overlay.is-reveal .boss-cine-text{
  opacity:1;
}

.battle-pause-overlay{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.75);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:#fff;
  z-index:9000;
  cursor:pointer;
  backdrop-filter:blur(4px);
}
.battle-pause-overlay.low-perf{backdrop-filter:none}
.battle-pause-icon{font-size:48px;margin-bottom:16px}
.battle-pause-title{font-size:22px;font-weight:800;margin-bottom:8px}
.battle-pause-hint{font-size:13px;opacity:.5}

/* 低階機降級：保留核心戰鬥動作，僅關閉昂貴視覺效果 */
.low-perf-mode .scene-bg{transition:none!important}
.low-perf-mode .battle-root{backdrop-filter:none!important}
.low-perf-mode .battle-hp-card{backdrop-filter:none}
.battle-root.low-perf .scene-bg,
.battle-root.low-perf .battle-scene-sky,
.battle-root.low-perf .battle-scene-ground,
.battle-root.low-perf .battle-scene-platform-top,
.battle-root.low-perf .battle-scene-platform-bottom,
.battle-root.low-perf .battle-scene-deco,
.battle-root.low-perf .battle-weather-layer{
  transform:none!important;
  will-change:auto;
}
.battle-root.low-perf .battle-weather-layer{display:none}
.battle-root.low-perf .boss-cine-flash{display:none}
.battle-root.low-perf .boss-cine-blackout,
.battle-root.low-perf .boss-cine-scene,
.battle-root.low-perf .boss-cine-silhouette,
.battle-root.low-perf .boss-cine-text{
  transition:none;
}

@media (max-width:768px){
  .battle-arena{min-height:250px}
  .battle-panel.is-question{min-height:228px}
  .battle-panel.is-normal{min-height:184px}
  .battle-menu-wrap{padding:9px 9px 10px}
  .battle-menu-grid{gap:7px}
  .battle-menu-btn{min-height:86px;padding:10px 9px}
  .battle-item-row{gap:6px;margin-top:7px}
  .battle-item-btn{font-size:10.5px;padding:4px 9px;min-height:29px}
  .move-name-row{padding-right:68px}
  .move-icon{font-size:18px}
  .move-name{font-size:14px}
  .move-desc-row{font-size:11px;line-height:1.2}
  .battle-util-row{gap:6px;margin-top:7px}
  .battle-util-btn{font-size:11px;padding:5px 10px;min-height:30px}

  .battle-info-enemy{
    top:8px;
    left:8px;
    right:calc(var(--battle-enemy-info-right,42%) + 2%);
  }
  .battle-info-player{
    bottom:8px;
    right:8px;
    left:calc(var(--battle-player-info-left,42%) + 2%);
  }
  .battle-hp-card{padding:7px 10px;border-radius:11px}
  .battle-hp-label{font-size:13px}
  .battle-hp-value{font-size:10px}
  .battle-hp-track{height:7px}
  .battle-xp-track{height:3px}
  .battle-status-chip{font-size:10px;padding:2px 7px}

  .battle-top-right-stack{top:8px;right:8px}
  .battle-left-badge-stack{left:8px;bottom:64px}
  .battle-charge-meter{left:8px;bottom:44px;padding:3px 7px}

  .battle-sprite-enemy-main{
    --battle-enemy-main-scale:.97;
  }
  .battle-sprite-enemy-sub{
    --battle-enemy-sub-scale:.95;
  }
  .battle-sprite-player-main{
    --battle-player-main-scale:.97;
  }
  .battle-sprite-player-sub{
    --battle-player-sub-scale:.94;
  }
}

@media (max-width:480px){
  .battle-arena{min-height:220px}
  .battle-panel.is-question{min-height:248px}
  .battle-panel.is-normal{min-height:196px}
  .battle-menu-wrap{padding:8px}
  .battle-menu-hint{font-size:11px;margin-bottom:7px}
  .battle-menu-grid{gap:6px}
  .battle-menu-btn{min-height:90px;padding:9px 8px;border-radius:11px}
  .battle-item-row{gap:5px}
  .battle-item-btn{font-size:10px;padding:4px 8px;min-height:28px}
  .battle-item-btn-count{font-size:7px}
  .move-name-row{padding-right:62px;min-height:20px}
  .move-icon{font-size:17px}
  .move-name{font-size:13px}
  .move-desc-row{font-size:10px;padding-right:2px}
  .move-badge{font-size:8px;padding:2px 5px}
  .move-badge-level{font-size:8px}

  .battle-info-enemy{
    top:6px;
    left:6px;
    right:calc(var(--battle-enemy-info-right,42%) + 4%);
  }
  .battle-info-player{
    bottom:6px;
    right:6px;
    left:calc(var(--battle-player-info-left,42%) + 4%);
  }
  .battle-hp-card{padding:6px 8px;border-radius:10px}
  .battle-hp-row{margin-bottom:3px}
  .battle-hp-label{font-size:12px}
  .battle-hp-value{font-size:9px}
  .battle-hp-track{height:6px}
  .battle-status-row{gap:3px}
  .battle-status-chip{font-size:9px;padding:1px 6px}

  .battle-top-right-stack{top:6px;right:6px;gap:3px}
  .battle-pill{font-size:9px;padding:3px 7px}
  .battle-left-badge-stack{left:6px;bottom:58px}
  .battle-charge-meter{left:6px;bottom:38px;padding:2px 6px}
  .battle-charge-dot{width:10px;height:10px}
  .battle-charge-max{font-size:8px}

  .battle-util-row{justify-content:flex-end;gap:5px;margin-top:7px}
  .battle-util-btn{
    flex:0 0 auto;
    font-size:10.5px;
    padding:4px 8px;
    min-height:28px;
    text-align:center;
  }

  .battle-sprite-enemy-main{
    --battle-enemy-main-scale:.94;
  }
  .battle-sprite-enemy-sub{
    --battle-enemy-sub-scale:.9;
  }
  .battle-sprite-player-main{
    --battle-player-main-scale:.94;
  }
  .battle-sprite-player-sub{
    --battle-player-sub-scale:.9;
  }

  .battle-question-wrap{padding:8px 10px}
  .battle-question-title{font-size:14px}
  .battle-question-sub,.battle-question-note{font-size:11px}
  .battle-question-expression{font-size:30px}
  .battle-answer-grid{gap:6px}
  .battle-answer-btn{font-size:24px;padding:10px 7px}
}

@media (max-width:420px){
  .battle-eff-toast{top:14%;font-size:12px;padding:6px 12px}
  .battle-level-toast{font-size:12px;padding:5px 12px;max-width:90vw}
  .battle-item-btn{font-size:9.5px;padding:3px 7px}
  .move-name-row{padding-right:58px}
  .move-name{font-size:12px}
  .battle-util-btn{font-size:10.5px!important;padding:4px 8px!important}
  .battle-pill{font-size:9px}
  .battle-boss-hint{font-size:12px;padding:5px 12px;max-width:90vw;text-align:center}
  .battle-question-expression{font-size:28px}
  .answer-btn{min-height:54px;font-size:28px!important;padding:12px 8px!important}
  .question-expression{font-size:36px!important}
}

/* ── Ambient elemental particle keyframes ── */
@keyframes ambientRise {
  0%   { transform: translate(-50%, -50%) translateY(0)   rotate(var(--r, 0deg)); opacity: 0; }
  15%  { opacity: 0.7; }
  85%  { opacity: 0.5; }
  100% { transform: translate(-50%, -50%) translateY(-18px) rotate(var(--r, 0deg)); opacity: 0; }
}
@keyframes ambientFall {
  0%   { transform: translate(-50%, -50%) translateY(0)    rotate(var(--r, 0deg)); opacity: 0; }
  15%  { opacity: 0.65; }
  85%  { opacity: 0.4; }
  100% { transform: translate(-50%, -50%) translateY(16px) rotate(calc(var(--r, 0deg) + 30deg)); opacity: 0; }
}
@keyframes ambientOrbit {
  0%   { transform: translate(-50%, -50%) translate(0, 0)      rotate(var(--r, 0deg)); opacity: 0; }
  15%  { opacity: 0.6; }
  50%  { transform: translate(-50%, -50%) translate(8px, -6px)  rotate(calc(var(--r, 0deg) + 90deg)); opacity: 0.7; }
  85%  { opacity: 0.4; }
  100% { transform: translate(-50%, -50%) translate(-4px, 4px)  rotate(calc(var(--r, 0deg) + 180deg)); opacity: 0; }
}
@keyframes ambientFloat {
  0%   { transform: translate(-50%, -50%) translateY(0)    scale(0.8); opacity: 0; }
  20%  { opacity: 0.65; transform: translate(-50%, -50%) translateY(-5px) scale(1); }
  80%  { opacity: 0.5;  transform: translate(-50%, -50%) translateY(-12px) scale(0.95); }
  100% { transform: translate(-50%, -50%) translateY(-16px) scale(0.7); opacity: 0; }
}
@keyframes ambientFlicker {
  0%   { opacity: 0; transform: translate(-50%, -50%) scale(0.6); }
  10%  { opacity: 0.8; transform: translate(-50%, -50%) scale(1.1); }
  30%  { opacity: 0.2; transform: translate(-50%, -50%) scale(0.8); }
  50%  { opacity: 0.9; transform: translate(-50%, -50%) scale(1.05); }
  70%  { opacity: 0.15; transform: translate(-50%, -50%) scale(0.7); }
  90%  { opacity: 0.7; transform: translate(-50%, -50%) scale(1); }
  100% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
}
@keyframes weatherRainFall{
  0%{transform:translate3d(0,0,0) rotate(12deg);opacity:0}
  8%{opacity:var(--wop)}
  100%{transform:translate3d(-14px,128%,0) rotate(12deg);opacity:0}
}
@keyframes weatherSnowFall{
  0%{transform:translate3d(0,0,0);opacity:0}
  10%{opacity:var(--wop)}
  55%{transform:translate3d(var(--wsway),58%,0)}
  100%{transform:translate3d(calc(var(--wsway) * -1),122%,0);opacity:0}
}
@keyframes weatherFogDrift{
  0%{transform:translate3d(0,0,0) scale(1)}
  50%{transform:translate3d(24px,-5px,0) scale(1.04)}
  100%{transform:translate3d(0,0,0) scale(1)}
}
@keyframes weatherDustFlow{
  0%{transform:translate3d(0,0,0) scale(.7);opacity:0}
  15%{opacity:var(--wop)}
  100%{transform:translate3d(112vw,var(--wdy),0) scale(1.08);opacity:0}
}
@keyframes weatherLightning{
  0%{opacity:0}
  56%{opacity:0}
  57%{opacity:.72}
  58.5%{opacity:.15}
  59.5%{opacity:.85}
  61%{opacity:.2}
  62%{opacity:0}
  100%{opacity:0}
}
@keyframes weatherSunPulse{
  0%{opacity:.5;transform:scale(.98)}
  50%{opacity:.68;transform:scale(1.04)}
  100%{opacity:.5;transform:scale(.98)}
}
/* ── Boss intro cinematic overlay ── */
.boss-intro-overlay{
  position:absolute;
  inset:0;
  z-index:9999;
  pointer-events:auto;
  overflow:hidden;
  cursor:pointer;
}
.battle-root.boss-intro-active .battle-arena,
.battle-root.boss-intro-active .battle-panel,
.battle-root.boss-intro-active .battle-hit-react-layer{
  visibility:hidden;
}

/* Phase 1 – full black, fades at 1.2 s */
.boss-intro-black{
  position:absolute;
  inset:0;
  background:#000;
  animation:bossIntroBlackFade 1.4s ease forwards;
}
@keyframes bossIntroBlackFade{
  0%{opacity:1}
  70%{opacity:1}
  100%{opacity:0}
}

/* Phase 2 – white flash burst */
.boss-intro-flash{
  position:absolute;
  inset:0;
  background:radial-gradient(circle at 50% 42%,rgba(255,255,255,.95),rgba(255,255,255,.5) 40%,transparent 72%);
  opacity:0;
  animation:bossIntroFlash 1.2s ease 0.7s both;
}
@keyframes bossIntroFlash{
  0%{opacity:0;transform:scale(.8)}
  30%{opacity:1;transform:scale(1.05)}
  60%{opacity:.6;transform:scale(1)}
  100%{opacity:0;transform:scale(1.1)}
}

/* Phase 3 – boss silhouette → full colour */
.boss-intro-silhouette-wrap{
  position:absolute;
  top:18%;
  left:50%;
  transform:translateX(-50%);
  width:min(84vw,720px);
  display:flex;
  align-items:flex-end;
  justify-content:center;
  gap:clamp(20px,5vw,52px);
  pointer-events:none;
}
.boss-intro-silhouette{
  position:relative;
  transform:scale(1.5);
  opacity:0;
  --boss-intro-shadow-delay:1.1s;
  --boss-intro-color-delay:1.34s;
  animation:bossIntroSilhouette 1.9s cubic-bezier(.22,.68,.36,1) 1.06s both;
  will-change:transform,opacity;
}
.boss-intro-silhouette-wrap.is-dual .boss-intro-silhouette-main{
  --boss-intro-shadow-delay:1.02s;
  --boss-intro-color-delay:1.26s;
  animation-delay:1s;
}
.boss-intro-silhouette-wrap.is-dual .boss-intro-silhouette-sub{
  --boss-intro-shadow-delay:1.16s;
  --boss-intro-color-delay:1.4s;
  animation-delay:1.14s;
}
.boss-intro-sprite-stack{
  display:grid;
}
.boss-intro-sprite{
  grid-area:1 / 1;
}
.boss-intro-sprite-shadow{
  filter:brightness(0) contrast(1.08) drop-shadow(0 0 18px rgba(120,40,80,.68));
  opacity:0;
  animation:bossIntroShadowFade 1.1s ease var(--boss-intro-shadow-delay) both;
}
.boss-intro-sprite-color{
  opacity:0;
  animation:bossIntroColorReveal 1.05s cubic-bezier(.2,.72,.28,1) var(--boss-intro-color-delay) both;
}
@keyframes bossIntroShadowFade{
  0%{opacity:0}
  20%{opacity:1}
  62%{opacity:.95}
  100%{opacity:0}
}
@keyframes bossIntroColorReveal{
  0%{opacity:0}
  36%{opacity:.24}
  72%{opacity:.72}
  100%{opacity:1}
}
@keyframes bossIntroSilhouette{
  0%{opacity:0;transform:scale(1.24)}
  22%{opacity:1;transform:scale(1.5)}
  62%{opacity:1;transform:scale(1.45)}
  100%{opacity:1;transform:scale(1.4)}
}

/* Phase 4 – boss name text pop */
.boss-intro-name{
  position:absolute;
  bottom:22%;
  left:50%;
  transform:translateX(-50%) scale(0);
  color:#fff;
  font-size:clamp(22px,5vw,36px);
  font-weight:900;
  letter-spacing:3px;
  text-shadow:
    0 0 20px rgba(168,85,247,.8),
    0 0 40px rgba(120,40,80,.6),
    0 2px 6px rgba(0,0,0,.7);
  white-space:nowrap;
  opacity:0;
  animation:bossIntroNamePop .8s cubic-bezier(.16,.84,.44,1) 1.9s both;
}
.boss-intro-name.is-dual{
  white-space:normal;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  text-align:center;
  max-width:min(94vw,860px);
  padding:0 14px;
}
.boss-intro-name-separator{
  opacity:.9;
  font-size:.7em;
  letter-spacing:.12em;
}
@keyframes bossIntroSkipGlow{
  0%,100%{opacity:.46}
  50%{opacity:.9}
}
.boss-intro-skip-hint{
  position:absolute;
  right:16px;
  bottom:14px;
  color:rgba(255,255,255,.88);
  font-size:11px;
  font-weight:700;
  letter-spacing:.04em;
  text-shadow:0 1px 4px rgba(0,0,0,.8);
  animation:bossIntroSkipGlow .9s ease-in-out infinite;
}
@keyframes bossIntroNamePop{
  0%{opacity:0;transform:translateX(-50%) scale(0)}
  50%{opacity:1;transform:translateX(-50%) scale(1.18)}
  75%{transform:translateX(-50%) scale(.96)}
  100%{opacity:1;transform:translateX(-50%) scale(1)}
}

/* Final dim-out veil */
.boss-intro-fadeout{
  position:absolute;
  inset:0;
  opacity:0;
  background:#000;
  animation:bossIntroFadeOut .5s ease 4.1s both;
}
@keyframes bossIntroFadeOut{
  0%{opacity:0}
  60%{opacity:.4}
  100%{opacity:0}
}

/* Low-perf: skip the overlay entirely (handled in JS) */
.battle-root.low-perf .boss-intro-overlay{display:none}

@media (max-width: 640px) {
  .boss-intro-silhouette-wrap{
    top:21%;
    width:min(92vw,540px);
    gap:clamp(10px,4vw,22px);
  }
  .boss-intro-silhouette{
    transform:scale(1.26);
  }
  .boss-intro-name{
    bottom:24%;
    letter-spacing:1.6px;
  }
  .boss-intro-name.is-dual{
    gap:5px;
    font-size:clamp(16px,4.2vw,24px);
  }
}

@media (prefers-reduced-motion: reduce) {
  .scene-bg,
  .battle-scene-sky,
  .battle-scene-ground,
  .battle-scene-platform-top,
  .battle-scene-platform-bottom,
  .battle-scene-deco,
  .battle-weather-layer{
    transform:none!important;
    will-change:auto;
  }
  .battle-weather-layer{opacity:.7}
  [aria-hidden="true"] > div { animation: none !important; opacity: 0.4 !important; }
  .boss-intro-overlay { display: none !important; }
}
