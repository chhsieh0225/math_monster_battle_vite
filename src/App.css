*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Noto Sans TC',sans-serif;overflow:hidden;height:100vh;height:100dvh;background:#000;-webkit-user-select:none;user-select:none}
button{font-family:inherit;cursor:pointer;-webkit-tap-highlight-color:transparent}
button:active{transform:scale(0.96)!important}

.skip-link{
  position:absolute;
  left:10px;
  top:-48px;
  z-index:10050;
  background:#111827;
  color:#fff;
  border:2px solid rgba(251,191,36,0.95);
  border-radius:10px;
  padding:8px 12px;
  font-size:13px;
  font-weight:700;
  text-decoration:none;
  transition:top .15s ease;
}
.skip-link:focus-visible{top:10px}

button:focus-visible,
a:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
[role="button"]:focus-visible{
  outline:3px solid #fbbf24;
  outline-offset:2px;
  box-shadow:0 0 0 3px rgba(15,23,42,.6);
}

@keyframes dmgPop{0%{transform:translateY(0) scale(0.5);opacity:0}20%{transform:translateY(-10px) scale(1.2);opacity:1}40%{transform:translateY(-20px) scale(1);opacity:1}100%{transform:translateY(-50px);opacity:0}}
@keyframes flashWhite{0%{filter:brightness(1)}15%{filter:brightness(3)}30%{filter:brightness(1)}45%{filter:brightness(2.5)}60%{filter:brightness(1)}}
@keyframes popIn{0%{transform:scale(0.8);opacity:0}100%{transform:scale(1);opacity:1}}
@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}
@keyframes spinSelect{0%{transform:rotateY(0deg)}100%{transform:rotateY(360deg)}}
@keyframes fadeSlide{0%{transform:translateY(12px);opacity:0}100%{transform:translateY(0);opacity:1}}
@keyframes screenFadeIn{0%{opacity:0;transform:translateY(6px)}100%{opacity:1;transform:translateY(0)}}
.screen-transition{animation:screenFadeIn .22s ease-out}
@keyframes sparkle{0%{transform:scale(0) rotate(0deg);opacity:1}50%{transform:scale(1) rotate(180deg);opacity:1}100%{transform:scale(0) rotate(360deg);opacity:0}}
@keyframes emberRise{0%{transform:translateY(0) scale(1);opacity:0.6}40%{opacity:0.9}100%{transform:translateY(-110px) scale(0.2);opacity:0}}
@keyframes lavaGlow{0%,100%{opacity:0.18;transform:scale(1)}50%{opacity:0.35;transform:scale(1.15)}}
@keyframes float{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-8px) scale(1.03)}}
@keyframes timerShrink{0%{width:100%}100%{width:0%}}
@keyframes timerUrgent{0%{background:#ef4444}50%{background:#fbbf24}100%{background:#ef4444}}
@keyframes fireballFly{0%{transform:translate(0,0) scale(0.3);opacity:0}15%{transform:translate(20px,-10px) scale(1);opacity:1}85%{transform:translate(160px,-80px) scale(1.2);opacity:1}100%{transform:translate(180px,-90px) scale(0.5);opacity:0}}
@keyframes fireTrail{0%{transform:translate(0,0) scale(0);opacity:0}10%{opacity:0.8;transform:scale(1)}100%{transform:translate(-30px,15px) scale(0);opacity:0}}
@keyframes lightningStrike{0%{transform-origin:50% 100%;transform:scaleY(.05) scaleX(.92);opacity:0}18%{transform:scaleY(1.02) scaleX(1);opacity:1}38%{transform:scaleY(.94) scaleX(1.01);opacity:.35}52%{transform:scaleY(1.06) scaleX(1);opacity:.9}72%{transform:scaleY(.96) scaleX(.99);opacity:.28}84%{transform:scaleY(1.01) scaleX(1);opacity:.78}100%{transform:scaleY(.78) scaleX(.98);opacity:0}}
@keyframes lightningFlash{0%{background:transparent}10%{background:rgba(251,191,36,0.15)}20%{background:transparent}30%{background:rgba(251,191,36,0.1)}40%{background:transparent}100%{background:transparent}}
@keyframes waterWave{0%{transform:translateX(-100%) scaleY(0.3);opacity:0}20%{transform:translateX(-40%) scaleY(1);opacity:0.8}60%{transform:translateX(60%) scaleY(1.1);opacity:0.7}100%{transform:translateX(120%) scaleY(0.5);opacity:0}}
@keyframes waterDrop{0%{transform:translate(0,0) scale(0);opacity:0}20%{transform:translate(var(--dx),var(--dy)) scale(1);opacity:0.9}100%{transform:translate(var(--dx),calc(var(--dy) + 40px)) scale(0.3);opacity:0}}
@keyframes darkPulse{0%{transform:scale(0);opacity:0;background:rgba(88,28,135,0.8)}30%{transform:scale(1);opacity:0.9}60%{transform:scale(1.8);opacity:0.5;background:rgba(168,85,247,0.3)}100%{transform:scale(2.5);opacity:0}}
@keyframes darkScreenFlash{0%{background:transparent}15%{background:rgba(0,0,0,0.7)}30%{background:rgba(88,28,135,0.4)}50%{background:rgba(0,0,0,0.5)}70%{background:rgba(168,85,247,0.2)}100%{background:transparent}}
@keyframes leafSlash{0%{transform:translate(0,0) rotate(-45deg) scale(0);opacity:0}20%{transform:translate(40px,-20px) rotate(0deg) scale(1.2);opacity:1}70%{transform:translate(140px,-70px) rotate(30deg) scale(1);opacity:0.8}100%{transform:translate(180px,-90px) rotate(45deg) scale(0.3);opacity:0}}
@keyframes leafBurst{0%{transform:translate(0,0) rotate(0deg) scale(0);opacity:0}15%{transform:scale(1);opacity:0.9}100%{transform:translate(var(--lx),var(--ly)) rotate(var(--lr)) scale(0);opacity:0}}
@keyframes grassScreenFlash{0%{background:transparent}12%{background:rgba(34,197,94,0.15)}25%{background:transparent}35%{background:rgba(74,222,128,0.1)}50%{background:transparent}100%{background:transparent}}
@keyframes evolveFlash{0%{opacity:0}8%{opacity:0.95}30%{opacity:0.3}45%{opacity:0.7}100%{opacity:0}}
@keyframes evolveSpin{from{transform:rotate(0deg) translateX(var(--orbit)) rotate(0deg)}to{transform:rotate(360deg) translateX(var(--orbit)) rotate(-360deg)}}
@keyframes evolveGlow{0%,100%{filter:drop-shadow(0 0 8px rgba(99,102,241,0.3))}50%{filter:drop-shadow(0 0 30px rgba(99,102,241,0.8)) drop-shadow(0 0 60px rgba(168,85,247,0.4))}}
@keyframes growIn{0%{transform:scale(0.2);opacity:0;filter:brightness(3)}35%{transform:scale(1.2);filter:brightness(1.5)}60%{transform:scale(0.95)}100%{transform:scale(1);opacity:1;filter:brightness(1)}}
@keyframes colorBurst{0%{transform:scale(0);opacity:0.8}100%{transform:scale(4);opacity:0}}
@keyframes bgShimmer{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

/* ─── SVG Attack Effect Keyframes ─── */
@keyframes leafBladeFly{0%{transform:translate(0,0) rotate(-30deg) scale(0.3);opacity:0}15%{transform:translate(calc(var(--fly-x)*0.13),calc(var(--fly-y)*0.13)) rotate(-5deg) scale(1.1);opacity:1}80%{transform:translate(calc(var(--fly-x)*0.84),calc(var(--fly-y)*0.84)) rotate(15deg) scale(1);opacity:0.9}100%{transform:translate(var(--fly-x),var(--fly-y)) rotate(30deg) scale(0.4);opacity:0}}
@keyframes vineWhipDraw{0%{stroke-dashoffset:300;opacity:0}8%{opacity:1}85%{stroke-dashoffset:0;opacity:1}100%{stroke-dashoffset:-50;opacity:0}}
@keyframes leafSpin{0%{transform:translate(0,0) rotate(0deg) scale(0);opacity:0}20%{transform:translate(calc(var(--lx)*0.2),calc(var(--ly)*0.2)) rotate(90deg) scale(1);opacity:0.9}100%{transform:translate(var(--lx),var(--ly)) rotate(360deg) scale(0.2);opacity:0}}
@keyframes windSweep{0%{transform:translateX(-110%) scaleY(0.4);opacity:0}20%{transform:translateX(-30%) scaleY(1);opacity:0.7}100%{transform:translateX(110%) scaleY(0.6);opacity:0}}
@keyframes bubbleFloat{0%{transform:translate(0,0) scale(0.2);opacity:0}20%{transform:translate(calc(var(--fly-x)*0.17),calc(var(--fly-y)*0.17)) scale(1);opacity:0.9}75%{transform:translate(calc(var(--fly-x)*0.76),calc(var(--fly-y)*0.76)) scale(1.05);opacity:0.7}100%{transform:translate(var(--fly-x),var(--fly-y)) scale(0.6);opacity:0}}
@keyframes waveSweep{0%{transform:translateX(-110%) scaleY(0.3);opacity:0}20%{transform:translateX(-30%) scaleY(1);opacity:0.9}60%{transform:translateX(50%) scaleY(1.1);opacity:0.7}100%{transform:translateX(120%) scaleY(0.5);opacity:0}}
@keyframes splashBurst{0%{transform:translate(0,0) scale(0.3);opacity:0}20%{transform:translate(calc(var(--px)*0.2),calc(var(--py)*0.2)) scale(1);opacity:0.9}100%{transform:translate(var(--px),var(--py)) scale(0.1);opacity:0}}
@keyframes flameFly{0%{transform:translate(0,0) scale(0.2) rotate(10deg);opacity:0}12%{transform:translate(calc(var(--fly-x)*0.11),calc(var(--fly-y)*0.11)) scale(1) rotate(0deg);opacity:1}82%{transform:translate(calc(var(--fly-x)*0.86),calc(var(--fly-y)*0.86)) scale(1.15) rotate(-5deg);opacity:0.95}100%{transform:translate(var(--fly-x),var(--fly-y)) scale(0.4) rotate(-10deg);opacity:0}}
@keyframes fireExpand{0%{transform:scale(0);opacity:0}25%{transform:scale(0.6);opacity:0.9}50%{transform:scale(1);opacity:0.7}100%{transform:scale(1.8);opacity:0}}
@keyframes darkRingExpand{0%{transform:scale(0);opacity:0}25%{transform:scale(0.8);opacity:1}60%{transform:scale(1.5);opacity:0.5}100%{transform:scale(2.2);opacity:0}}
@keyframes darkStarSpin{0%{transform:translate(0,0) rotate(0deg) scale(0);opacity:0}25%{transform:translate(calc(var(--sx)*0.3),calc(var(--sy)*0.3)) rotate(90deg) scale(1);opacity:1}100%{transform:translate(var(--sx),var(--sy)) rotate(360deg) scale(0.2);opacity:0}}
@keyframes arcFlow{0%{stroke-dashoffset:40;opacity:0}15%{opacity:0.8}100%{stroke-dashoffset:-40;opacity:0}}
@keyframes ultGlow{0%{opacity:0}20%{opacity:1}50%{opacity:0.6}75%{opacity:0.8}100%{opacity:0}}
@keyframes ultApproach{0%{transform:translate(0,0) scale(0.3);opacity:0}12%{transform:translate(calc(var(--fly-x)*0.09),calc(var(--fly-y)*0.09)) scale(0.7);opacity:0.35}55%{transform:translate(calc(var(--fly-x)*0.65),calc(var(--fly-y)*0.65)) scale(0.85);opacity:0.3}80%{transform:translate(calc(var(--fly-x)*0.91),calc(var(--fly-y)*0.91)) scale(1);opacity:0.5}100%{transform:translate(var(--fly-x),var(--fly-y)) scale(1.6);opacity:0}}

/* ─── Scene ambient particle keyframes ─── */
@keyframes leafDrift{0%{transform:translate(0,0) rotate(0deg) scale(0.5);opacity:0}10%{opacity:0.7}50%{transform:translate(var(--ldx),var(--ldy)) rotate(180deg) scale(1);opacity:0.6}100%{transform:translate(calc(var(--ldx)*1.8),calc(var(--ldy)*2.2)) rotate(360deg) scale(0.3);opacity:0}}
@keyframes fireflyGlow{0%{transform:translate(0,0) scale(0.6);opacity:0}15%{opacity:var(--ff-op)}40%{transform:translate(var(--fx),var(--fy)) scale(1);opacity:var(--ff-op)}60%{transform:translate(calc(var(--fx)*0.7),calc(var(--fy)*1.3)) scale(0.8);opacity:calc(var(--ff-op)*0.5)}80%{transform:translate(var(--fx),calc(var(--fy)*0.6)) scale(1.1);opacity:var(--ff-op)}100%{transform:translate(calc(var(--fx)*1.5),var(--fy)) scale(0.4);opacity:0}}
@keyframes steelSpark{0%{transform:scale(0);opacity:0}20%{transform:scale(1.2);opacity:0.9}40%{transform:scale(0.8);opacity:0.4}60%{transform:scale(1);opacity:0.7}100%{transform:scale(0);opacity:0}}
@keyframes smokeDrift{0%{transform:translate(0,0) scale(var(--sm-s,1));opacity:0}10%{opacity:var(--sm-op,0.3)}50%{transform:translate(var(--sm-dx),var(--sm-dy)) scale(calc(var(--sm-s,1)*1.3));opacity:var(--sm-op,0.3)}85%{transform:translate(calc(var(--sm-dx)*1.4),calc(var(--sm-dy)*0.5)) scale(calc(var(--sm-s,1)*1.6));opacity:calc(var(--sm-op,0.3)*0.4)}100%{transform:translate(calc(var(--sm-dx)*1.6),calc(var(--sm-dy)*0.3)) scale(calc(var(--sm-s,1)*1.8));opacity:0}}
@keyframes lightPulse{0%,100%{opacity:var(--lp-lo,0.04)}50%{opacity:var(--lp-hi,0.1)}}

:root{
  --touch-target:44px;
  --battle-panel-top:#1f2c42;
  --battle-panel-mid:#0f172a;
  --battle-panel-bottom:#0a1220;
}
.touch-btn,.back-touch-btn,.title-action-btn,.title-feature-btn,.title-perf-btn,.selection-confirm-btn,.end-action-btn{min-height:var(--touch-target)}
.back-touch-btn{width:var(--touch-target)!important;height:var(--touch-target)!important;min-width:var(--touch-target);font-size:18px!important}
button{touch-action:manipulation;min-height:var(--touch-target);min-width:var(--touch-target)}
input,select,textarea{font-size:max(16px,1rem)}

.app-error-wrap{
  min-height:100vh;
  min-height:100dvh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:10px;
  padding:22px;
  color:#fff;
  background:radial-gradient(circle at 50% 18%,rgba(185,28,28,.35),rgba(2,6,23,.98) 55%);
  text-align:center;
}
.app-error-icon{font-size:46px}
.app-error-title{font-size:20px;font-weight:900}
.app-error-detail{
  max-width:min(90vw,560px);
  font-size:13px;
  color:#fecaca;
  opacity:.95;
  word-break:break-word;
}
.app-error-reload{
  margin-top:8px;
  border:none;
  border-radius:12px;
  padding:11px 18px;
  font-size:14px;
  font-weight:800;
  color:#fff;
  background:#dc2626;
}
.app-error-reload:hover{background:#b91c1c}

.shell-root{
  min-height:100vh;
  min-height:100dvh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.shell-stage{
  width:100vw;
  height:100vh;
  height:100dvh;
  position:relative;
}
.rotate-overlay{
  position:absolute;
  inset:0;
  z-index:12000;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:#fff;
  gap:10px;
  text-align:center;
  background:rgba(2,6,23,.84);
}
.rotate-overlay-icon{font-size:44px}
.rotate-overlay-title{font-size:20px;font-weight:900}
.rotate-overlay-subtitle{font-size:13px;opacity:.86}
.rotate-overlay-hint{
  margin-top:6px;
  font-size:12px;
  opacity:.7;
}



@media (max-width:480px){
  :root{--touch-target:46px}
}

@media (max-width:420px){
  .title-action-btn{font-size:17px!important;padding:16px 0!important}
  .title-feature-btn{font-size:14px!important;padding:12px 0!important}
  .title-perf-btn{font-size:13px!important;padding:11px 12px!important}
  .selection-confirm-btn{font-size:18px!important;padding:15px 0!important}
  .end-action-btn{font-size:14px!important;padding:12px 16px!important}
}

@media (prefers-reduced-motion: reduce){
  *, *::before, *::after{animation-duration:0.01ms!important}
}
