*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{font-family:'Noto Sans TC',sans-serif;overflow:hidden;height:100vh;height:100dvh;background:#000;-webkit-user-select:none;user-select:none}
button{font-family:inherit;cursor:pointer;-webkit-tap-highlight-color:transparent}
button:active{transform:scale(0.96)!important}
.scene-bg{position:absolute;inset:0;background-size:cover;background-position:center;image-rendering:auto;z-index:0;}

.skip-link{
  position:absolute;
  left:10px;
  top:-48px;
  z-index:10050;
  background:#111827;
  color:#fff;
  border:2px solid rgba(251,191,36,0.95);
  border-radius:10px;
  padding:8px 12px;
  font-size:13px;
  font-weight:700;
  text-decoration:none;
  transition:top .15s ease;
}
.skip-link:focus-visible{top:10px}

button:focus-visible,
a:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
[role="button"]:focus-visible{
  outline:3px solid #fbbf24;
  outline-offset:2px;
  box-shadow:0 0 0 3px rgba(15,23,42,.6);
}

@keyframes enemyHit{0%{transform:translate(0,0)}10%{transform:translate(8px,-4px)}20%{transform:translate(-6px,2px)}30%{transform:translate(4px,-2px)}50%{transform:translate(0,0)}100%{transform:translate(0,0)}}
@keyframes playerHit{0%{transform:translate(0,0) scaleX(-1)}10%{transform:translate(-8px,4px) scaleX(-1)}20%{transform:translate(6px,-2px) scaleX(-1)}50%{transform:translate(0,0) scaleX(-1)}100%{transform:translate(0,0) scaleX(-1)}}
@keyframes attackLunge{0%{transform:translate(0,0) scaleX(-1)}30%{transform:translate(60px,-40px) scaleX(-1)}50%{transform:translate(60px,-40px) scaleX(-1)}100%{transform:translate(0,0) scaleX(-1)}}
@keyframes enemyAttackLunge{0%{transform:translate(0,0)}30%{transform:translate(-60px,40px)}50%{transform:translate(-60px,40px)}100%{transform:translate(0,0)}}
@keyframes dmgPop{0%{transform:translateY(0) scale(0.5);opacity:0}20%{transform:translateY(-10px) scale(1.2);opacity:1}40%{transform:translateY(-20px) scale(1);opacity:1}100%{transform:translateY(-50px);opacity:0}}
@keyframes flashWhite{0%{filter:brightness(1)}15%{filter:brightness(3)}30%{filter:brightness(1)}45%{filter:brightness(2.5)}60%{filter:brightness(1)}}
@keyframes popIn{0%{transform:scale(0.8);opacity:0}100%{transform:scale(1);opacity:1}}
@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}
@keyframes spinSelect{0%{transform:rotateY(0deg)}100%{transform:rotateY(360deg)}}
@keyframes fadeSlide{0%{transform:translateY(12px);opacity:0}100%{transform:translateY(0);opacity:1}}
@keyframes chargeGlow{0%{filter:drop-shadow(0 0 4px rgba(255,200,0,0))}50%{filter:drop-shadow(0 0 16px rgba(255,200,0,0.8))}100%{filter:drop-shadow(0 0 4px rgba(255,200,0,0))}}
@keyframes slideInBattle{0%{transform:translateX(120px);opacity:0}100%{transform:translateX(0);opacity:1}}
@keyframes slideInPlayer{0%{transform:translateX(-120px) scaleX(-1);opacity:0}100%{transform:translateX(0) scaleX(-1);opacity:1}}
@keyframes sparkle{0%{transform:scale(0) rotate(0deg);opacity:1}50%{transform:scale(1) rotate(180deg);opacity:1}100%{transform:scale(0) rotate(360deg);opacity:0}}
@keyframes emberRise{0%{transform:translateY(0) scale(1);opacity:0.6}40%{opacity:0.9}100%{transform:translateY(-110px) scale(0.2);opacity:0}}
@keyframes lavaGlow{0%,100%{opacity:0.18;transform:scale(1)}50%{opacity:0.35;transform:scale(1.15)}}
@keyframes float{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-8px) scale(1.03)}}
@keyframes floatFlip{0%,100%{transform:translateY(0) scaleX(-1) scaleY(1)}50%{transform:translateY(-6px) scaleX(-1.02) scaleY(1.04)}}
@keyframes shadowPulse{0%,100%{transform:scaleX(1) scaleY(1);opacity:0.55}50%{transform:scaleX(0.82) scaleY(0.82);opacity:0.25}}
@keyframes bossShadowPulse{0%,100%{transform:scaleX(1) scaleY(1);opacity:0.55}25%{transform:scaleX(0.9) scaleY(0.9);opacity:0.35}50%{transform:scaleX(1) scaleY(1);opacity:0.5}75%{transform:scaleX(0.85) scaleY(0.85);opacity:0.3}}
@keyframes shieldPulse{0%{transform:scale(0);opacity:0}20%{transform:scale(1.15);opacity:1}50%{transform:scale(1);opacity:0.85}80%{transform:scale(1.05);opacity:0.9}100%{transform:scale(1.1);opacity:0}}
@keyframes shieldFlash{0%{background:transparent}15%{background:rgba(251,191,36,0.25)}40%{background:transparent}55%{background:rgba(251,191,36,0.15)}100%{background:transparent}}
@keyframes dodgeSlide{0%{transform:translateX(0) scaleX(-1)}25%{transform:translateX(-60px) translateY(-20px) scaleX(-1);opacity:0.2}55%{transform:translateX(-60px) translateY(-20px) scaleX(-1);opacity:0.2}100%{transform:translateX(0) scaleX(-1);opacity:1}}
@keyframes dodgeFlash{0%{background:transparent}15%{background:rgba(56,189,248,0.2)}40%{background:transparent}55%{background:rgba(56,189,248,0.12)}100%{background:transparent}}
@keyframes vineCounter{0%{transform:scale(0) rotate(-30deg);opacity:0}25%{transform:scale(1.1) rotate(5deg);opacity:1}60%{transform:scale(1) rotate(0deg);opacity:0.9}100%{transform:scale(0) rotate(30deg);opacity:0}}
@keyframes counterFlash{0%{background:transparent}15%{background:rgba(34,197,94,0.2)}40%{background:transparent}55%{background:rgba(34,197,94,0.12)}100%{background:transparent}}
@keyframes specDefReady{0%,100%{filter:drop-shadow(0 0 6px rgba(251,191,36,0.3))}50%{filter:drop-shadow(0 0 16px rgba(251,191,36,0.8))}}
@keyframes timerShrink{0%{width:100%}100%{width:0%}}
@keyframes timerPulse{0%{opacity:1}50%{opacity:0.5}100%{opacity:1}}
@keyframes timerUrgent{0%{background:#ef4444}50%{background:#fbbf24}100%{background:#ef4444}}
@keyframes fireballFly{0%{transform:translate(0,0) scale(0.3);opacity:0}15%{transform:translate(20px,-10px) scale(1);opacity:1}85%{transform:translate(160px,-80px) scale(1.2);opacity:1}100%{transform:translate(180px,-90px) scale(0.5);opacity:0}}
@keyframes fireTrail{0%{transform:translate(0,0) scale(0);opacity:0}10%{opacity:0.8;transform:scale(1)}100%{transform:translate(-30px,15px) scale(0);opacity:0}}
@keyframes lightningStrike{0%{clip-path:inset(100% 0 0 0);opacity:0}20%{clip-path:inset(0 0 0 0);opacity:1;filter:brightness(2)}40%{opacity:0.3}50%{opacity:1;filter:brightness(3)}70%{opacity:0.2}80%{opacity:1;filter:brightness(2)}100%{opacity:0;filter:brightness(1)}}
@keyframes lightningFlash{0%{background:transparent}10%{background:rgba(251,191,36,0.15)}20%{background:transparent}30%{background:rgba(251,191,36,0.1)}40%{background:transparent}100%{background:transparent}}
@keyframes waterWave{0%{transform:translateX(-100%) scaleY(0.3);opacity:0}20%{transform:translateX(-40%) scaleY(1);opacity:0.8}60%{transform:translateX(60%) scaleY(1.1);opacity:0.7}100%{transform:translateX(120%) scaleY(0.5);opacity:0}}
@keyframes waterDrop{0%{transform:translate(0,0) scale(0);opacity:0}20%{transform:translate(var(--dx),var(--dy)) scale(1);opacity:0.9}100%{transform:translate(var(--dx),calc(var(--dy) + 40px)) scale(0.3);opacity:0}}
@keyframes darkPulse{0%{transform:scale(0);opacity:0;background:rgba(88,28,135,0.8)}30%{transform:scale(1);opacity:0.9}60%{transform:scale(1.8);opacity:0.5;background:rgba(168,85,247,0.3)}100%{transform:scale(2.5);opacity:0}}
@keyframes darkScreenFlash{0%{background:transparent}15%{background:rgba(0,0,0,0.7)}30%{background:rgba(88,28,135,0.4)}50%{background:rgba(0,0,0,0.5)}70%{background:rgba(168,85,247,0.2)}100%{background:transparent}}
@keyframes enemyGrassHit{0%{filter:brightness(1) hue-rotate(0deg);transform:translate(0,0)}15%{filter:brightness(1.8) hue-rotate(60deg);transform:translate(-5px,3px)}30%{filter:brightness(1.2) hue-rotate(30deg);transform:translate(4px,-2px)}50%{filter:brightness(1.5) hue-rotate(50deg);transform:translate(-3px,2px)}70%{filter:brightness(1.2);transform:translate(2px,0)}100%{filter:brightness(1) hue-rotate(0deg);transform:translate(0,0)}}
@keyframes leafSlash{0%{transform:translate(0,0) rotate(-45deg) scale(0);opacity:0}20%{transform:translate(40px,-20px) rotate(0deg) scale(1.2);opacity:1}70%{transform:translate(140px,-70px) rotate(30deg) scale(1);opacity:0.8}100%{transform:translate(180px,-90px) rotate(45deg) scale(0.3);opacity:0}}
@keyframes leafBurst{0%{transform:translate(0,0) rotate(0deg) scale(0);opacity:0}15%{transform:scale(1);opacity:0.9}100%{transform:translate(var(--lx),var(--ly)) rotate(var(--lr)) scale(0);opacity:0}}
@keyframes grassScreenFlash{0%{background:transparent}12%{background:rgba(34,197,94,0.15)}25%{background:transparent}35%{background:rgba(74,222,128,0.1)}50%{background:transparent}100%{background:transparent}}
@keyframes enemyFireHit{0%{filter:brightness(1)}20%{filter:brightness(2) hue-rotate(-20deg)}40%{filter:brightness(1.3)}60%{filter:brightness(1.8) hue-rotate(-10deg)}100%{filter:brightness(1)}}
@keyframes enemyElecHit{0%{filter:brightness(1);transform:translate(0,0)}10%{filter:brightness(3);transform:translate(3px,0)}20%{filter:brightness(1.5);transform:translate(-3px,0)}30%{filter:brightness(2.5);transform:translate(2px,0)}40%{filter:brightness(1);transform:translate(-2px,0)}50%{filter:brightness(2);transform:translate(0,0)}100%{filter:brightness(1);transform:translate(0,0)}}
@keyframes enemyWaterHit{0%{filter:brightness(1);transform:translate(0,0)}20%{filter:brightness(1.5) saturate(2);transform:translate(8px,0)}40%{filter:brightness(1.2);transform:translate(-4px,0)}60%{filter:brightness(1.3) saturate(1.5);transform:translate(2px,0)}100%{filter:brightness(1);transform:translate(0,0)}}
@keyframes enemyDarkHit{0%{filter:brightness(1);transform:scale(1)}15%{filter:brightness(0.2);transform:scale(0.9)}30%{filter:brightness(3);transform:scale(1.15)}50%{filter:brightness(0.5);transform:scale(0.95)}70%{filter:brightness(2);transform:scale(1.05)}100%{filter:brightness(1);transform:scale(1)}}
@keyframes evolveFlash{0%{opacity:0}8%{opacity:0.95}30%{opacity:0.3}45%{opacity:0.7}100%{opacity:0}}
@keyframes evolveSpin{from{transform:rotate(0deg) translateX(var(--orbit)) rotate(0deg)}to{transform:rotate(360deg) translateX(var(--orbit)) rotate(-360deg)}}
@keyframes evolveGlow{0%,100%{filter:drop-shadow(0 0 8px rgba(99,102,241,0.3))}50%{filter:drop-shadow(0 0 30px rgba(99,102,241,0.8)) drop-shadow(0 0 60px rgba(168,85,247,0.4))}}
@keyframes growIn{0%{transform:scale(0.2);opacity:0;filter:brightness(3)}35%{transform:scale(1.2);filter:brightness(1.5)}60%{transform:scale(0.95)}100%{transform:scale(1);opacity:1;filter:brightness(1)}}
@keyframes colorBurst{0%{transform:scale(0);opacity:0.8}100%{transform:scale(4);opacity:0}}
@keyframes bgShimmer{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes bossFloat{0%,100%{transform:translateY(0) scale(1)}25%{transform:translateY(-3px) scale(1.02)}50%{transform:translateY(-1px) scale(1)}75%{transform:translateY(-4px) scale(1.01)}}
@keyframes bossShake{0%,100%{transform:translateX(0)}10%{transform:translateX(-2px)}20%{transform:translateX(2px)}30%{transform:translateX(-1px)}40%{transform:translateX(1px)}50%{transform:translateX(0)}}
@keyframes bossPulse{0%,100%{filter:drop-shadow(0 0 4px rgba(120,40,80,0.3))}50%{filter:drop-shadow(0 0 12px rgba(180,60,100,0.6)) drop-shadow(0 0 20px rgba(120,40,80,0.3))}}

/* ─── SVG Attack Effect Keyframes ─── */
@keyframes leafBladeFly{0%{transform:translate(0,0) rotate(-30deg) scale(0.3);opacity:0}15%{transform:translate(calc(var(--fly-x)*0.13),calc(var(--fly-y)*0.13)) rotate(-5deg) scale(1.1);opacity:1}80%{transform:translate(calc(var(--fly-x)*0.84),calc(var(--fly-y)*0.84)) rotate(15deg) scale(1);opacity:0.9}100%{transform:translate(var(--fly-x),var(--fly-y)) rotate(30deg) scale(0.4);opacity:0}}
@keyframes vineWhipDraw{0%{stroke-dashoffset:300;opacity:0}8%{opacity:1}85%{stroke-dashoffset:0;opacity:1}100%{stroke-dashoffset:-50;opacity:0}}
@keyframes leafSpin{0%{transform:translate(0,0) rotate(0deg) scale(0);opacity:0}20%{transform:translate(calc(var(--lx)*0.2),calc(var(--ly)*0.2)) rotate(90deg) scale(1);opacity:0.9}100%{transform:translate(var(--lx),var(--ly)) rotate(360deg) scale(0.2);opacity:0}}
@keyframes windSweep{0%{transform:translateX(-110%) scaleY(0.4);opacity:0}20%{transform:translateX(-30%) scaleY(1);opacity:0.7}100%{transform:translateX(110%) scaleY(0.6);opacity:0}}
@keyframes bubbleFloat{0%{transform:translate(0,0) scale(0.2);opacity:0}20%{transform:translate(calc(var(--fly-x)*0.17),calc(var(--fly-y)*0.17)) scale(1);opacity:0.9}75%{transform:translate(calc(var(--fly-x)*0.76),calc(var(--fly-y)*0.76)) scale(1.05);opacity:0.7}100%{transform:translate(var(--fly-x),var(--fly-y)) scale(0.6);opacity:0}}
@keyframes waveSweep{0%{transform:translateX(-110%) scaleY(0.3);opacity:0}20%{transform:translateX(-30%) scaleY(1);opacity:0.9}60%{transform:translateX(50%) scaleY(1.1);opacity:0.7}100%{transform:translateX(120%) scaleY(0.5);opacity:0}}
@keyframes splashBurst{0%{transform:translate(0,0) scale(0.3);opacity:0}20%{transform:translate(calc(var(--px)*0.2),calc(var(--py)*0.2)) scale(1);opacity:0.9}100%{transform:translate(var(--px),var(--py)) scale(0.1);opacity:0}}
@keyframes flameFly{0%{transform:translate(0,0) scale(0.2) rotate(10deg);opacity:0}12%{transform:translate(calc(var(--fly-x)*0.11),calc(var(--fly-y)*0.11)) scale(1) rotate(0deg);opacity:1}82%{transform:translate(calc(var(--fly-x)*0.86),calc(var(--fly-y)*0.86)) scale(1.15) rotate(-5deg);opacity:0.95}100%{transform:translate(var(--fly-x),var(--fly-y)) scale(0.4) rotate(-10deg);opacity:0}}
@keyframes fireExpand{0%{transform:scale(0);opacity:0}25%{transform:scale(0.6);opacity:0.9}50%{transform:scale(1);opacity:0.7}100%{transform:scale(1.8);opacity:0}}
@keyframes darkRingExpand{0%{transform:scale(0);opacity:0}25%{transform:scale(0.8);opacity:1}60%{transform:scale(1.5);opacity:0.5}100%{transform:scale(2.2);opacity:0}}
@keyframes darkStarSpin{0%{transform:translate(0,0) rotate(0deg) scale(0);opacity:0}25%{transform:translate(calc(var(--sx)*0.3),calc(var(--sy)*0.3)) rotate(90deg) scale(1);opacity:1}100%{transform:translate(var(--sx),var(--sy)) rotate(360deg) scale(0.2);opacity:0}}
@keyframes arcFlow{0%{stroke-dashoffset:40;opacity:0}15%{opacity:0.8}100%{stroke-dashoffset:-40;opacity:0}}
@keyframes ultGlow{0%{opacity:0}20%{opacity:1}50%{opacity:0.6}75%{opacity:0.8}100%{opacity:0}}
@keyframes ultApproach{0%{transform:translate(0,0) scale(0.3);opacity:0}12%{transform:translate(calc(var(--fly-x)*0.09),calc(var(--fly-y)*0.09)) scale(0.7);opacity:0.35}55%{transform:translate(calc(var(--fly-x)*0.65),calc(var(--fly-y)*0.65)) scale(0.85);opacity:0.3}80%{transform:translate(calc(var(--fly-x)*0.91),calc(var(--fly-y)*0.91)) scale(1);opacity:0.5}100%{transform:translate(var(--fly-x),var(--fly-y)) scale(1.6);opacity:0}}
@keyframes ultSyncFlash{0%{opacity:0}20%{opacity:.82}60%{opacity:.36}100%{opacity:0}}
@keyframes ultSyncCore{0%{transform:translate(50%,-32%) scale(.25);opacity:0}18%{opacity:.95}58%{transform:translate(50%,-32%) scale(1.05);opacity:.7}100%{transform:translate(50%,-32%) scale(1.34);opacity:0}}
@keyframes ultSyncRing{0%{transform:scale(.2);opacity:0}28%{opacity:.95}100%{transform:scale(1.2);opacity:0}}
@keyframes battleImpactCharge{0%{transform:translateY(0) scale(1);filter:brightness(1) saturate(1)}100%{transform:translateY(-3px) scale(1.018);filter:brightness(1.08) saturate(1.11)}}
@keyframes battleImpactShake{0%{transform:translate(0,0) scale(1.02)}16%{transform:translate(-5px,2px) scale(1.018)}32%{transform:translate(5px,-2px) scale(1.02)}48%{transform:translate(-4px,2px) scale(1.018)}64%{transform:translate(4px,-1px) scale(1.015)}100%{transform:translate(0,0) scale(1.01)}}
@keyframes battleImpactSettle{0%{transform:translate(0,0) scale(1.01);filter:brightness(1.06)}100%{transform:translate(0,0) scale(1);filter:brightness(1)}}
@keyframes battleHitPulse{0%{opacity:0;transform:scale(1.22)}35%{opacity:.82;transform:scale(1)}100%{opacity:0;transform:scale(.94)}}
@keyframes battleHitPulseShake{0%{opacity:0}22%{opacity:.88}68%{opacity:.34}100%{opacity:0}}

/* ─── Scene ambient particle keyframes ─── */
@keyframes leafDrift{0%{transform:translate(0,0) rotate(0deg) scale(0.5);opacity:0}10%{opacity:0.7}50%{transform:translate(var(--ldx),var(--ldy)) rotate(180deg) scale(1);opacity:0.6}100%{transform:translate(calc(var(--ldx)*1.8),calc(var(--ldy)*2.2)) rotate(360deg) scale(0.3);opacity:0}}
@keyframes fireflyGlow{0%{transform:translate(0,0) scale(0.6);opacity:0}15%{opacity:var(--ff-op)}40%{transform:translate(var(--fx),var(--fy)) scale(1);opacity:var(--ff-op)}60%{transform:translate(calc(var(--fx)*0.7),calc(var(--fy)*1.3)) scale(0.8);opacity:calc(var(--ff-op)*0.5)}80%{transform:translate(var(--fx),calc(var(--fy)*0.6)) scale(1.1);opacity:var(--ff-op)}100%{transform:translate(calc(var(--fx)*1.5),var(--fy)) scale(0.4);opacity:0}}
@keyframes steelSpark{0%{transform:scale(0);opacity:0}20%{transform:scale(1.2);opacity:0.9}40%{transform:scale(0.8);opacity:0.4}60%{transform:scale(1);opacity:0.7}100%{transform:scale(0);opacity:0}}
@keyframes smokeDrift{0%{transform:translate(0,0) scale(var(--sm-s,1));opacity:0}10%{opacity:var(--sm-op,0.3)}50%{transform:translate(var(--sm-dx),var(--sm-dy)) scale(calc(var(--sm-s,1)*1.3));opacity:var(--sm-op,0.3)}85%{transform:translate(calc(var(--sm-dx)*1.4),calc(var(--sm-dy)*0.5)) scale(calc(var(--sm-s,1)*1.6));opacity:calc(var(--sm-op,0.3)*0.4)}100%{transform:translate(calc(var(--sm-dx)*1.6),calc(var(--sm-dy)*0.3)) scale(calc(var(--sm-s,1)*1.8));opacity:0}}
@keyframes lightPulse{0%,100%{opacity:var(--lp-lo,0.04)}50%{opacity:var(--lp-hi,0.1)}}

:root{
  --touch-target:44px;
  --battle-panel-top:#1f2c42;
  --battle-panel-mid:#0f172a;
  --battle-panel-bottom:#0a1220;
}
.touch-btn,.back-touch-btn,.battle-util-btn,.title-action-btn,.title-feature-btn,.title-perf-btn,.selection-confirm-btn,.answer-btn,.end-action-btn{min-height:var(--touch-target)}
.back-touch-btn{width:var(--touch-target)!important;height:var(--touch-target)!important;min-width:var(--touch-target);font-size:18px!important}
button{touch-action:manipulation;min-height:var(--touch-target);min-width:var(--touch-target)}
input,select,textarea{font-size:max(16px,1rem)}

.battle-root{
  height:100%;
  display:flex;
  flex-direction:column;
  position:relative;
  overflow:hidden;
  background:linear-gradient(180deg,#020617 0%,#0b1220 100%);
  cursor:default;
}
.battle-root-advance{cursor:pointer}
.battle-hit-react-layer{
  position:absolute;
  inset:0;
  z-index:66;
  pointer-events:none;
  opacity:0;
  mix-blend-mode:screen;
  background:radial-gradient(circle at 50% 45%,rgba(255,255,255,.18),rgba(251,113,133,.12) 26%,rgba(30,41,59,0) 72%);
}
.battle-hit-react-layer.is-ult{
  mix-blend-mode:hard-light;
  background:radial-gradient(circle at 50% 45%,rgba(255,228,164,.24),rgba(251,146,60,.2) 24%,rgba(127,29,29,.16) 42%,rgba(2,6,23,0) 74%);
}
.battle-hit-react-layer.is-charge{animation:battleHitPulse .16s ease-out both}
.battle-hit-react-layer.is-freeze{opacity:.42}
.battle-hit-react-layer.is-shake{animation:battleHitPulseShake .22s ease both}
.battle-hit-react-layer.is-settle{animation:battleHitPulse .2s ease-out reverse both}

.battle-root .battle-arena{
  will-change:transform,filter;
  transform-origin:center 48%;
}
.battle-root.battle-impact-charge .battle-arena{animation:battleImpactCharge .14s cubic-bezier(.19,.74,.22,1) both}
.battle-root.battle-impact-freeze .battle-arena{
  transform:translateY(-3px) scale(1.018);
  filter:brightness(1.12) saturate(1.14);
}
.battle-root.battle-impact-freeze .battle-sprite-enemy-main,
.battle-root.battle-impact-freeze .battle-sprite-player-main,
.battle-root.battle-impact-freeze .battle-sprite-enemy-sub,
.battle-root.battle-impact-freeze .battle-sprite-player-sub,
.battle-root.battle-impact-freeze .battle-sprite-enemy-shadow,
.battle-root.battle-impact-freeze .battle-sprite-player-shadow{animation-play-state:paused!important}
.battle-root.battle-impact-shake .battle-arena{animation:battleImpactShake .24s steps(2,end) both}
.battle-root.battle-impact-shake .battle-info-enemy,
.battle-root.battle-impact-shake .battle-info-player{transform:translateY(-2px)}
.battle-root.battle-impact-settle .battle-arena{animation:battleImpactSettle .2s ease-out both}
.battle-root.low-perf .battle-hit-react-layer{display:none}
.battle-root.low-perf.battle-impact-charge .battle-arena,
.battle-root.low-perf.battle-impact-shake .battle-arena,
.battle-root.low-perf.battle-impact-settle .battle-arena{
  animation:none!important;
  transform:none!important;
  filter:none!important;
}

.app-error-wrap{
  min-height:100vh;
  min-height:100dvh;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  gap:10px;
  padding:22px;
  color:#fff;
  background:radial-gradient(circle at 50% 18%,rgba(185,28,28,.35),rgba(2,6,23,.98) 55%);
  text-align:center;
}
.app-error-icon{font-size:46px}
.app-error-title{font-size:20px;font-weight:900}
.app-error-detail{
  max-width:min(90vw,560px);
  font-size:13px;
  color:#fecaca;
  opacity:.95;
  word-break:break-word;
}
.app-error-reload{
  margin-top:8px;
  border:none;
  border-radius:12px;
  padding:11px 18px;
  font-size:14px;
  font-weight:800;
  color:#fff;
  background:#dc2626;
}
.app-error-reload:hover{background:#b91c1c}

.shell-root{
  min-height:100vh;
  min-height:100dvh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.shell-stage{
  width:100vw;
  height:100vh;
  height:100dvh;
  position:relative;
}
.rotate-overlay{
  position:absolute;
  inset:0;
  z-index:12000;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:#fff;
  gap:10px;
  text-align:center;
  background:rgba(2,6,23,.84);
}
.rotate-overlay-icon{font-size:44px}
.rotate-overlay-title{font-size:20px;font-weight:900}
.rotate-overlay-subtitle{font-size:13px;opacity:.86}
.rotate-overlay-hint{
  margin-top:6px;
  font-size:12px;
  opacity:.7;
}

.battle-loading-wrap{
  width:100%;
  min-height:100vh;
  min-height:100dvh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  background:radial-gradient(circle at 50% 18%,rgba(15,23,42,.95),#020617 70%);
  color:#fff;
}
.battle-loading-icon{
  font-size:52px;
  margin-bottom:12px;
  animation:float 1.1s ease-in-out infinite;
}
.battle-loading-text{
  font-size:15px;
  color:rgba(226,232,240,.88);
}

.battle-arena{
  flex:1;
  position:relative;
  min-height:0;
  background:#111;
  transition:background 1s ease;
}
.battle-scene-sky{
  position:absolute;
  inset:0;
  background:var(--scene-sky,#0f172a);
  opacity:.25;
  z-index:1;
  transition:background 1s ease;
}
.battle-scene-ground{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  height:45%;
  background:var(--scene-ground,#1f2937);
  transition:background 1s ease;
  z-index:2;
}
.battle-scene-platform-top{
  position:absolute;
  right:5%;
  top:8%;
  width:55%;
  height:12px;
  background:var(--scene-platform-top,rgba(255,255,255,.2));
  border-radius:50%;
  filter:blur(2px);
  z-index:3;
}
.battle-scene-platform-bottom{
  position:absolute;
  left:2%;
  bottom:12%;
  width:50%;
  height:10px;
  background:var(--scene-platform-bottom,rgba(255,255,255,.2));
  border-radius:50%;
  filter:blur(2px);
  z-index:3;
}
.battle-scene-deco{
  position:absolute;
  inset:0;
  z-index:4;
  pointer-events:none;
}
.battle-info-enemy{
  position:absolute;
  top:10px;
  left:10px;
  right:var(--battle-enemy-info-right,42%);
  z-index:10;
}
.battle-info-player{
  position:absolute;
  bottom:10px;
  right:10px;
  left:var(--battle-player-info-left,42%);
  z-index:10;
}
.battle-hp-focus{
  opacity:.62;
  transform:scale(.98);
  filter:saturate(.72);
  transition:opacity .2s ease,transform .2s ease,filter .2s ease;
}
.battle-hp-focus.is-active{
  opacity:1;
  transform:scale(1);
  filter:none;
}
.battle-hp-sub-row{margin-top:4px}
.battle-hp-card{
  background:rgba(0,0,0,.65);
  border-radius:12px;
  padding:8px 12px;
  backdrop-filter:blur(8px);
  border:1px solid rgba(255,255,255,.1);
}
.battle-hp-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:4px;
}
.battle-hp-label{
  font-size:14px;
  font-weight:800;
  color:#fff;
}
.battle-hp-value{
  font-size:12px;
  color:rgba(255,255,255,.5);
  font-family:'Press Start 2P',monospace;
}
.battle-hp-track{
  height:8px;
  background:rgba(255,255,255,.15);
  border-radius:4px;
  overflow:hidden;
}
.battle-hp-fill{
  width:var(--battle-hp-width,0%);
  height:100%;
  background:var(--battle-hp-color,#22c55e);
  border-radius:4px;
  transition:width .6s ease;
}
.battle-xp-track{
  height:4px;
  background:rgba(255,255,255,.1);
  border-radius:2px;
  overflow:hidden;
  margin-top:4px;
}
.battle-xp-fill{
  width:var(--battle-xp-width,0%);
  height:100%;
  background:linear-gradient(90deg,#6366f1,#a855f7);
  border-radius:2px;
  transition:width .8s ease;
}
.battle-sprite-enemy-main{
  position:absolute;
  right:var(--enemy-main-right,10%);
  top:var(--enemy-main-top,26%);
  z-index:6;
  transform:scale(var(--battle-enemy-main-scale,1));
  transform-origin:top right;
  animation:var(--enemy-main-anim,none);
}
.battle-sprite-enemy-sub{
  position:absolute;
  right:var(--enemy-sub-right,24%);
  top:var(--enemy-sub-top,23%);
  z-index:4;
  opacity:.78;
  transform:scale(calc(var(--enemy-sub-scale,.8) * var(--battle-enemy-sub-scale,1)));
  transform-origin:top right;
  filter:saturate(.9);
  animation:var(--enemy-sub-anim,none);
}
.battle-sprite-enemy-shadow{
  position:absolute;
  right:var(--enemy-shadow-right);
  top:var(--enemy-shadow-top);
  width:var(--enemy-shadow-width);
  height:12px;
  background:radial-gradient(ellipse,rgba(0,0,0,.6),transparent);
  border-radius:50%;
  z-index:4;
  animation:var(--enemy-shadow-anim,shadowPulse 3s ease-in-out infinite);
}
.battle-sprite-player-main{
  position:absolute;
  left:var(--player-main-left,6%);
  bottom:var(--player-main-bottom,14%);
  transform:scaleX(-1) scale(var(--battle-player-main-scale,1));
  transform-origin:center bottom;
  z-index:6;
  filter:var(--player-main-filter,none);
  transition:filter .2s ease;
  animation:var(--player-main-anim,none);
}
.battle-sprite-player-sub{
  position:absolute;
  left:var(--player-sub-left,23%);
  bottom:var(--player-sub-bottom,15%);
  transform:scaleX(-1) scale(var(--battle-player-sub-scale,1));
  transform-origin:center bottom;
  z-index:4;
  opacity:.84;
  filter:var(--player-sub-filter,none);
  transition:filter .2s ease;
  animation:var(--player-sub-anim,none);
}
.battle-sprite-player-shadow{
  position:absolute;
  left:var(--player-shadow-left);
  bottom:var(--player-shadow-bottom);
  width:var(--player-shadow-width);
  height:10px;
  background:radial-gradient(ellipse,rgba(0,0,0,.55),transparent);
  border-radius:50%;
  z-index:4;
  animation:shadowPulse 3s ease-in-out infinite;
}

.battle-def-fx{
  position:absolute;
  left:6%;
  bottom:14%;
  z-index:50;
  pointer-events:none;
}
.battle-def-fx-fire,.battle-def-fx-grass,.battle-def-fx-electric{width:160px;height:160px}
.battle-def-fx-water{width:130px;height:130px}
.battle-def-fx-light{width:170px;height:170px}

.battle-def-layer{
  position:absolute;
  inset:0;
  border-radius:50%;
}
.battle-def-layer-fire-core{
  background:radial-gradient(circle,rgba(251,191,36,.5),rgba(245,158,11,.15),transparent 70%);
  animation:shieldPulse 1.2s ease forwards;
}
.battle-def-layer-fire-ring{
  inset:-10px;
  border:3px solid rgba(251,191,36,.6);
  animation:shieldPulse 1.2s ease .1s forwards;
  opacity:0;
}
.battle-def-layer-water-ripple-1,.battle-def-layer-water-ripple-2,.battle-def-layer-water-ripple-3{
  background:radial-gradient(circle,rgba(56,189,248,.35),transparent 70%);
  animation:shieldPulse .8s ease forwards;
  opacity:0;
}
.battle-def-layer-water-ripple-2{animation-delay:.15s}
.battle-def-layer-water-ripple-3{animation-delay:.3s}
.battle-def-layer-grass-core{
  background:radial-gradient(circle,rgba(34,197,94,.45),rgba(22,163,74,.12),transparent 70%);
  animation:vineCounter 1.4s ease forwards;
}
.battle-def-layer-grass-ring{
  inset:-5px;
  border:3px solid rgba(34,197,94,.5);
  animation:vineCounter 1.4s ease .1s forwards;
  opacity:0;
}
.battle-def-layer-electric-core{
  background:radial-gradient(circle,rgba(251,191,36,.5),rgba(234,179,8,.15),transparent 70%);
  animation:shieldPulse 1.2s ease forwards;
}
.battle-def-layer-electric-ring{
  inset:-8px;
  border:3px solid rgba(251,191,36,.6);
  animation:shieldPulse 1.2s ease .1s forwards;
  opacity:0;
}
.battle-def-layer-light-core{
  background:radial-gradient(circle,rgba(245,158,11,.55),rgba(251,191,36,.2),transparent 70%);
  animation:shieldPulse 1.2s ease forwards;
}
.battle-def-layer-light-ring{
  inset:-8px;
  border:3px solid rgba(245,158,11,.6);
  animation:shieldPulse 1.2s ease .1s forwards;
  opacity:0;
}
.battle-def-layer-light-ring-outer{
  inset:-16px;
  border:2px solid rgba(251,191,36,.3);
  animation:shieldPulse 1.2s ease .2s forwards;
  opacity:0;
}

.battle-def-icon{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  animation:popIn .3s ease;
}
.battle-def-icon-fire,.battle-def-icon-electric,.battle-def-icon-light{font-size:48px}
.battle-def-icon-grass{font-size:44px}
.battle-def-icon-water{font-size:40px}
.battle-def-icon-fire,.battle-def-icon-electric{filter:drop-shadow(0 0 12px rgba(251,191,36,.8))}
.battle-def-icon-water{filter:drop-shadow(0 0 10px rgba(56,189,248,.8))}
.battle-def-icon-grass{filter:drop-shadow(0 0 10px rgba(34,197,94,.8))}
.battle-def-icon-light{filter:drop-shadow(0 0 14px rgba(245,158,11,.9))}

.battle-def-screen{
  position:absolute;
  inset:0;
  z-index:45;
  pointer-events:none;
}
.battle-def-screen-fire,.battle-def-screen-electric,.battle-def-screen-light{animation:shieldFlash .8s ease}
.battle-def-screen-water{animation:dodgeFlash .8s ease}
.battle-def-screen-grass{animation:counterFlash .8s ease}

.battle-eff-toast{
  position:absolute;
  top:15%;
  left:50%;
  transform:translateX(-50%);
  color:#fff;
  padding:7px 16px;
  border-radius:999px;
  font-size:13px;
  font-weight:800;
  z-index:220;
  pointer-events:none;
  animation:popIn .24s ease;
  letter-spacing:.4px;
  border:1px solid rgba(255,255,255,.24);
  backdrop-filter:blur(6px);
  text-shadow:0 1px 2px rgba(0,0,0,.45);
  max-width:min(88vw,420px);
  text-align:center;
  box-shadow:var(--battle-eff-shadow,0 8px 22px rgba(15,23,42,.42));
}
.battle-eff-toast-good{background:linear-gradient(135deg,rgba(21,128,61,.93),rgba(22,163,74,.9))}
.battle-eff-toast-bad{background:linear-gradient(135deg,rgba(71,85,105,.92),rgba(51,65,85,.92))}

.battle-ult-sync{
  --ult-sync-core-1:rgba(157,142,195,.78);
  --ult-sync-core-2:rgba(91,33,182,.46);
  --ult-sync-flash:rgba(2,6,23,.45);
  --ult-sync-ring:rgba(157,142,195,.55);
  --ult-sync-ring-soft:rgba(196,181,253,.36);
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:79;
}
.battle-ult-sync.is-fire{
  --ult-sync-core-1:rgba(251,146,60,.7);
  --ult-sync-core-2:rgba(157,23,77,.45);
  --ult-sync-flash:rgba(127,29,29,.35);
  --ult-sync-ring:rgba(251,191,36,.55);
}
.battle-ult-sync.is-water{
  --ult-sync-core-1:rgba(56,189,248,.72);
  --ult-sync-core-2:rgba(30,64,175,.44);
  --ult-sync-flash:rgba(2,132,199,.32);
  --ult-sync-ring:rgba(125,211,252,.55);
}
.battle-ult-sync.is-electric{
  --ult-sync-core-1:rgba(251,191,36,.76);
  --ult-sync-core-2:rgba(124,58,237,.4);
  --ult-sync-flash:rgba(202,138,4,.32);
  --ult-sync-ring:rgba(254,240,138,.55);
}
.battle-ult-sync.is-grass{
  --ult-sync-core-1:rgba(74,222,128,.7);
  --ult-sync-core-2:rgba(6,78,59,.42);
  --ult-sync-flash:rgba(22,163,74,.34);
  --ult-sync-ring:rgba(134,239,172,.52);
}
.battle-ult-sync.is-light{
  --ult-sync-core-1:rgba(251,191,36,.75);
  --ult-sync-core-2:rgba(147,51,234,.36);
  --ult-sync-flash:rgba(245,158,11,.3);
  --ult-sync-ring:rgba(254,240,138,.58);
}
.battle-ult-sync-flash{
  position:absolute;
  inset:0;
  background:radial-gradient(circle at calc(100% - var(--ult-sync-right)) var(--ult-sync-top),var(--ult-sync-flash),transparent 65%);
  animation:ultSyncFlash .75s ease both;
}
.battle-ult-sync-core{
  position:absolute;
  right:var(--ult-sync-right);
  top:var(--ult-sync-top);
  width:136px;
  height:136px;
  border-radius:50%;
  transform:translate(50%,-32%);
  background:radial-gradient(circle,var(--ult-sync-core-1),var(--ult-sync-core-2) 56%,transparent 78%);
  filter:blur(.2px);
  animation:ultSyncCore .86s cubic-bezier(.18,.72,.22,1) both;
}
.battle-ult-sync-ring{
  position:absolute;
  right:calc(var(--ult-sync-right) - 44px);
  top:calc(var(--ult-sync-top) - 26px);
  width:210px;
  height:108px;
  border-radius:50%;
  border:2px solid var(--ult-sync-ring);
  opacity:0;
  animation:ultSyncRing .88s ease .06s both;
}
.battle-ult-sync-ring-alt{
  border-color:var(--ult-sync-ring-soft);
  animation-delay:.14s;
}

.battle-level-toast{
  position:absolute;
  top:60px;
  left:50%;
  transform:translateX(-50%);
  background:linear-gradient(135deg,rgba(251,191,36,.9),rgba(245,158,11,.9));
  color:#fff;
  padding:6px 18px;
  border-radius:20px;
  font-size:13px;
  font-weight:700;
  z-index:200;
  animation:popIn .3s ease;
  box-shadow:0 4px 16px rgba(245,158,11,.4);
  white-space:nowrap;
}

.battle-status-row{
  display:flex;
  gap:4px;
  margin-top:3px;
  flex-wrap:wrap;
}
.battle-status-chip{
  color:#fff;
  padding:2px 8px;
  border-radius:8px;
  font-size:11px;
  font-weight:700;
  animation:popIn .3s ease;
  letter-spacing:.1px;
}
.battle-status-chip.is-burn{background:rgba(239,68,68,.85)}
.battle-status-chip.is-freeze{background:rgba(56,189,248,.85)}
.battle-status-chip.is-paralyze{background:rgba(234,179,8,.85)}
.battle-status-chip.is-static{background:rgba(234,179,8,.85)}
.battle-status-chip.is-counter{background:rgba(99,102,241,.85)}
.battle-status-chip.is-counter-soft{background:rgba(99,102,241,.72)}
.battle-status-chip.is-boss{background:rgba(168,85,247,.85)}
.battle-status-chip.is-charge{background:rgba(251,191,36,.9);color:#000}
.battle-status-chip.is-curse{background:rgba(168,85,247,.85)}
.battle-status-chip-inline{display:inline-block;margin-top:3px}

.battle-top-right-stack{
  position:absolute;
  top:10px;
  right:10px;
  z-index:20;
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:4px;
  pointer-events:none;
}
.battle-pill{
  border-radius:14px;
  font-size:10px;
  font-weight:700;
  color:#fff;
  padding:3px 9px;
  animation:popIn .3s ease;
  white-space:nowrap;
}
.battle-pill.is-streak{background:linear-gradient(135deg,#f59e0b,#ef4444);font-size:11px}
.battle-pill.is-passive{
  background:rgba(99,102,241,.8);
  display:flex;
  align-items:center;
  gap:3px;
}
.battle-pill.is-timed{
  background:rgba(239,68,68,.7);
  backdrop-filter:blur(4px);
}
.battle-top-right-stack.low-perf .battle-pill.is-timed{backdrop-filter:none}
.battle-pill.is-diff-up{background:rgba(239,68,68,.7)}
.battle-pill.is-diff-down{background:rgba(56,189,248,.7)}

.battle-charge-meter{
  position:absolute;
  bottom:50px;
  left:10px;
  display:flex;
  align-items:center;
  gap:4px;
  z-index:20;
  background:rgba(0,0,0,.3);
  padding:3px 8px;
  border-radius:10px;
  backdrop-filter:blur(4px);
}
.battle-charge-meter.low-perf{backdrop-filter:none}
.battle-charge-dot{
  width:11px;
  height:11px;
  border-radius:6px;
  background:rgba(0,0,0,.15);
  border:2px solid rgba(255,255,255,.4);
  transition:all .3s;
}
.battle-charge-dot.is-on{background:#f59e0b}
.battle-charge-dot.is-glow{animation:chargeGlow 1.5s ease infinite}
.battle-charge-max{
  font-size:9px;
  color:#b45309;
  font-weight:700;
  margin-left:2px;
  animation:popIn .3s ease;
}

.battle-left-badge-stack{
  position:absolute;
  bottom:70px;
  left:10px;
  z-index:20;
  display:flex;
  flex-direction:column;
  align-items:flex-start;
  gap:4px;
}
.battle-pill.is-last-stand{
  background:linear-gradient(135deg,rgba(251,191,36,.9),rgba(245,158,11,.9));
  box-shadow:0 2px 12px rgba(251,191,36,.4);
  animation:popIn .3s ease,specDefReady 2s ease infinite;
  font-size:11px;
  padding:3px 10px;
}
.battle-pill.is-specdef{
  font-size:11px;
  padding:3px 10px;
  animation:popIn .3s ease,specDefReady 2s ease infinite;
}
.battle-pill-specdef-fire{
  background:linear-gradient(135deg,rgba(251,191,36,.9),rgba(245,158,11,.9));
  box-shadow:0 2px 12px rgba(251,191,36,.4);
}
.battle-pill-specdef-water{
  background:linear-gradient(135deg,rgba(56,189,248,.9),rgba(14,165,233,.9));
  box-shadow:0 2px 12px rgba(56,189,248,.4);
}
.battle-pill-specdef-electric{
  background:linear-gradient(135deg,rgba(251,191,36,.9),rgba(234,179,8,.9));
  box-shadow:0 2px 12px rgba(234,179,8,.4);
}
.battle-pill-specdef-light{
  background:linear-gradient(135deg,rgba(245,158,11,.9),rgba(217,119,6,.9));
  box-shadow:0 2px 12px rgba(245,158,11,.4);
}
.battle-pill-specdef-grass{
  background:linear-gradient(135deg,rgba(34,197,94,.9),rgba(22,163,74,.9));
  box-shadow:0 2px 12px rgba(34,197,94,.4);
}
.battle-boss-hint{
  position:absolute;
  top:40%;
  left:50%;
  transform:translateX(-50%);
  z-index:20;
  background:rgba(251,191,36,.95);
  color:#000;
  padding:6px 16px;
  border-radius:12px;
  font-size:14px;
  font-weight:800;
  animation:popIn .3s ease;
  box-shadow:0 4px 20px rgba(251,191,36,.6);
}

.battle-panel{
  background:linear-gradient(180deg,var(--battle-panel-top) 0%,var(--battle-panel-mid) 52%,var(--battle-panel-bottom) 100%);
  border-top:1px solid rgba(255,255,255,.13);
  box-shadow:0 -10px 24px rgba(2,6,23,.5);
  flex-shrink:0;
  position:relative;
}
.battle-panel.is-question{min-height:210px}
.battle-panel.is-normal{min-height:170px}

.battle-menu-wrap{padding:10px}
.battle-menu-hint{
  margin-bottom:8px;
  font-size:12px;
  font-weight:700;
  color:rgba(226,232,240,.78);
  letter-spacing:.2px;
}
.battle-menu-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}

.battle-menu-btn{
  min-height:88px;
  border-radius:12px;
  padding:10px;
  text-align:left;
  position:relative;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  justify-content:flex-start;
  gap:3px;
  transition:transform .15s ease,border-color .2s ease,filter .2s ease,opacity .2s ease;
  background:var(--move-bg,rgba(255,255,255,.08));
  border:2px solid var(--move-border,rgba(255,255,255,.15));
  opacity:var(--move-opacity,1);
  cursor:var(--move-cursor,pointer);
  animation:fadeSlide .3s ease var(--move-enter-delay,0s) both;
}
.battle-menu-btn:not(:disabled):hover{transform:translateY(-1px)}
.battle-menu-btn.is-locked{filter:saturate(.75)}

.move-sealed-mask{
  position:absolute;
  inset:0;
  background:rgba(76,29,149,.2);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:3;
  border-radius:12px;
}
.move-sealed-text{
  font-size:16px;
  font-weight:800;
  color:#e9d5ff;
  text-shadow:0 2px 8px rgba(0,0,0,.55);
}

.move-badge-stack{
  position:absolute;
  top:6px;
  right:6px;
  display:flex;
  flex-direction:column;
  align-items:flex-end;
  gap:3px;
  z-index:2;
}
.move-badge{
  font-size:9px;
  font-weight:800;
  padding:2px 6px;
  border-radius:999px;
  line-height:1;
  color:#fff;
  white-space:nowrap;
  box-shadow:0 1px 8px rgba(0,0,0,.25);
}
.move-badge-level{
  font-family:'Press Start 2P',monospace;
  font-size:9px;
  padding:3px 6px;
  background:var(--move-level-bg,#64748b);
}
.move-badge-level.cap{background:linear-gradient(135deg,#f59e0b,#dc2626)}
.move-badge-up{background:#16a34a}
.move-badge-down{background:#64748b}

.move-name-row{
  display:flex;
  align-items:center;
  gap:5px;
  margin-bottom:1px;
  min-height:22px;
  padding-right:74px;
}
.move-icon{font-size:20px;line-height:1}
.move-name{
  font-size:15px;
  font-weight:700;
  line-height:1.15;
  text-shadow:0 1px 2px rgba(0,0,0,.2);
  color:var(--move-name-color,#e2e8f0);
}
.move-desc-row{
  font-size:12px;
  line-height:1.24;
  color:var(--move-desc-color,#94a3b8);
  padding-right:6px;
  word-break:break-word;
}
.move-power{color:var(--move-power-color,inherit)}
.move-progress-track{
  height:3px;
  background:rgba(15,23,42,.45);
  border-radius:2px;
  margin-top:4px;
  overflow:hidden;
}
.move-progress-fill{
  height:100%;
  border-radius:2px;
  transition:width .3s;
  width:var(--move-progress-width,0%);
  background:var(--move-progress-color,#22c55e);
}

.battle-util-row{
  display:flex;
  justify-content:flex-end;
  gap:8px;
  margin-top:8px;
  flex-wrap:wrap;
}
.battle-util-btn{
  background:rgba(148,163,184,.08);
  border:1px solid rgba(148,163,184,.28);
  color:rgba(226,232,240,.92);
  font-size:11px;
  font-weight:700;
  padding:5px 10px;
  border-radius:999px;
  min-height:30px;
  line-height:1.2;
  transition:background .15s ease,border-color .15s ease,color .15s ease,transform .15s ease,opacity .15s ease;
}
.battle-util-btn:not(:disabled):hover{
  background:rgba(148,163,184,.16);
  border-color:rgba(203,213,225,.5);
  color:#fff;
}
.battle-util-btn:disabled{opacity:.55;cursor:not-allowed}
.battle-util-btn-danger{
  border-color:rgba(248,113,113,.32);
  color:#fecaca;
}
.battle-util-btn-danger:not(:disabled):hover{
  background:rgba(127,29,29,.25);
  border-color:rgba(248,113,113,.5);
  color:#fee2e2;
}

.battle-question-wrap{padding:10px 14px;animation:fadeSlide .25s ease}
.battle-question-head{
  display:flex;
  align-items:center;
  gap:6px;
  margin-bottom:8px;
  flex-wrap:wrap;
}
.battle-question-icon{font-size:18px}
.battle-question-title{font-size:16px;font-weight:700;color:#fff}
.battle-question-sub{font-size:13px;color:rgba(255,255,255,.6)}
.battle-question-note{font-size:12px;color:rgba(255,255,255,.42)}
.battle-question-card{
  background:rgba(255,255,255,.08);
  border-radius:12px;
  padding:10px 16px;
  text-align:center;
  margin-bottom:8px;
  border:1px solid rgba(255,255,255,.1);
  position:relative;
  overflow:hidden;
}
.battle-timer-bar{
  position:absolute;
  bottom:0;
  left:0;
  height:4px;
  background:var(--battle-timer-tone,#22c55e);
  width:var(--battle-timer-width,100%);
  border-radius:2px;
  transition:width .05s linear,background .3s;
  animation:var(--battle-timer-pulse,none);
}
.battle-timer-text{
  font-size:11px;
  font-weight:700;
  color:var(--battle-timer-text-tone,rgba(255,255,255,.4));
  margin-top:2px;
  font-family:'Press Start 2P',monospace;
  transition:color .3s;
}
.battle-question-type{font-size:10px;color:rgba(255,255,255,.35);margin-bottom:2px}
.battle-question-expression{font-size:36px;font-weight:900;color:#fff;letter-spacing:2px}
.battle-feedback{
  text-align:center;
  margin-bottom:4px;
  font-size:16px;
  font-weight:700;
  animation:popIn .2s ease;
}
.battle-feedback.is-correct{color:#22c55e}
.battle-feedback.is-wrong{color:#ef4444}
.battle-feedback-steps{
  background:rgba(239,68,68,.08);
  border:1px solid rgba(239,68,68,.2);
  border-radius:10px;
  padding:8px 12px;
  margin-bottom:6px;
  animation:fadeIn .4s ease;
}
.battle-feedback-steps-title{
  font-size:11px;
  color:#fca5a5;
  font-weight:700;
  margin-bottom:4px;
}
.battle-feedback-step-row{
  font-size:13px;
  color:rgba(255,255,255,.8);
  font-weight:600;
  line-height:1.8;
  font-family:monospace;
}
.battle-feedback-step-index{
  color:#fca5a5;
  font-size:11px;
  margin-right:4px;
}
.battle-answer-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:7px;
}
.battle-answer-btn{
  border-radius:10px;
  padding:12px 8px;
  font-size:26px;
  font-weight:700;
  transition:all .2s;
  background:rgba(255,255,255,.08);
  border:2px solid rgba(255,255,255,.15);
  color:#fff;
}
.battle-answer-btn.is-correct{
  background:rgba(34,197,94,.2);
  border-color:#22c55e;
  color:#22c55e;
}
.battle-answer-btn.is-dim{
  background:rgba(255,255,255,.03);
  border-color:rgba(255,255,255,.08);
  color:rgba(255,255,255,.3);
}

.battle-pause-overlay{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.75);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  color:#fff;
  z-index:9000;
  cursor:pointer;
  backdrop-filter:blur(4px);
}
.battle-pause-overlay.low-perf{backdrop-filter:none}
.battle-pause-icon{font-size:48px;margin-bottom:16px}
.battle-pause-title{font-size:22px;font-weight:800;margin-bottom:8px}
.battle-pause-hint{font-size:13px;opacity:.5}

/* 低階機降級：保留核心戰鬥動作，僅關閉昂貴視覺效果 */
.low-perf-mode .scene-bg{transition:none!important}
.low-perf-mode .battle-root{backdrop-filter:none!important}
.low-perf-mode .battle-hp-card{backdrop-filter:none}

@media (max-width:768px){
  .battle-arena{min-height:250px}
  .battle-panel.is-question{min-height:228px}
  .battle-panel.is-normal{min-height:184px}
  .battle-menu-wrap{padding:9px 9px 10px}
  .battle-menu-grid{gap:7px}
  .battle-menu-btn{min-height:86px;padding:10px 9px}
  .move-name-row{padding-right:68px}
  .move-icon{font-size:18px}
  .move-name{font-size:14px}
  .move-desc-row{font-size:11px;line-height:1.2}
  .battle-util-row{gap:6px;margin-top:7px}
  .battle-util-btn{font-size:11px;padding:5px 10px;min-height:30px}

  .battle-info-enemy{
    top:8px;
    left:8px;
    right:calc(var(--battle-enemy-info-right,42%) + 2%);
  }
  .battle-info-player{
    bottom:8px;
    right:8px;
    left:calc(var(--battle-player-info-left,42%) + 2%);
  }
  .battle-hp-card{padding:7px 10px;border-radius:11px}
  .battle-hp-label{font-size:13px}
  .battle-hp-value{font-size:10px}
  .battle-hp-track{height:7px}
  .battle-xp-track{height:3px}
  .battle-status-chip{font-size:10px;padding:2px 7px}

  .battle-top-right-stack{top:8px;right:8px}
  .battle-left-badge-stack{left:8px;bottom:64px}
  .battle-charge-meter{left:8px;bottom:44px;padding:3px 7px}

  .battle-sprite-enemy-main{
    --battle-enemy-main-scale:.97;
  }
  .battle-sprite-enemy-sub{
    --battle-enemy-sub-scale:.95;
  }
  .battle-sprite-player-main{
    --battle-player-main-scale:.97;
  }
  .battle-sprite-player-sub{
    --battle-player-sub-scale:.94;
  }
}

@media (max-width:480px){
  :root{--touch-target:46px}
  .battle-arena{min-height:220px}
  .battle-panel.is-question{min-height:248px}
  .battle-panel.is-normal{min-height:196px}
  .battle-menu-wrap{padding:8px}
  .battle-menu-hint{font-size:11px;margin-bottom:7px}
  .battle-menu-grid{gap:6px}
  .battle-menu-btn{min-height:90px;padding:9px 8px;border-radius:11px}
  .move-name-row{padding-right:62px;min-height:20px}
  .move-icon{font-size:17px}
  .move-name{font-size:13px}
  .move-desc-row{font-size:10px;padding-right:2px}
  .move-badge{font-size:8px;padding:2px 5px}
  .move-badge-level{font-size:8px}

  .battle-info-enemy{
    top:6px;
    left:6px;
    right:calc(var(--battle-enemy-info-right,42%) + 4%);
  }
  .battle-info-player{
    bottom:6px;
    right:6px;
    left:calc(var(--battle-player-info-left,42%) + 4%);
  }
  .battle-hp-card{padding:6px 8px;border-radius:10px}
  .battle-hp-row{margin-bottom:3px}
  .battle-hp-label{font-size:12px}
  .battle-hp-value{font-size:9px}
  .battle-hp-track{height:6px}
  .battle-status-row{gap:3px}
  .battle-status-chip{font-size:9px;padding:1px 6px}

  .battle-top-right-stack{top:6px;right:6px;gap:3px}
  .battle-pill{font-size:9px;padding:3px 7px}
  .battle-left-badge-stack{left:6px;bottom:58px}
  .battle-charge-meter{left:6px;bottom:38px;padding:2px 6px}
  .battle-charge-dot{width:10px;height:10px}
  .battle-charge-max{font-size:8px}

  .battle-util-row{justify-content:flex-end;gap:5px;margin-top:7px}
  .battle-util-btn{
    flex:0 0 auto;
    font-size:10.5px;
    padding:4px 8px;
    min-height:28px;
    text-align:center;
  }

  .battle-sprite-enemy-main{
    --battle-enemy-main-scale:.94;
  }
  .battle-sprite-enemy-sub{
    --battle-enemy-sub-scale:.9;
  }
  .battle-sprite-player-main{
    --battle-player-main-scale:.94;
  }
  .battle-sprite-player-sub{
    --battle-player-sub-scale:.9;
  }

  .battle-question-wrap{padding:8px 10px}
  .battle-question-title{font-size:14px}
  .battle-question-sub,.battle-question-note{font-size:11px}
  .battle-question-expression{font-size:30px}
  .battle-answer-grid{gap:6px}
  .battle-answer-btn{font-size:24px;padding:10px 7px}
}

@media (max-width:420px){
  .battle-eff-toast{top:14%;font-size:12px;padding:6px 12px}
  .battle-level-toast{font-size:12px;padding:5px 12px;max-width:90vw}
  .title-action-btn{font-size:17px!important;padding:16px 0!important}
  .title-feature-btn{font-size:14px!important;padding:12px 0!important}
  .title-perf-btn{font-size:13px!important;padding:11px 12px!important}
  .selection-confirm-btn{font-size:18px!important;padding:15px 0!important}
  .move-name-row{padding-right:58px}
  .move-name{font-size:12px}
  .battle-util-btn{font-size:10.5px!important;padding:4px 8px!important}
  .battle-pill{font-size:9px}
  .battle-boss-hint{font-size:12px;padding:5px 12px;max-width:90vw;text-align:center}
  .battle-question-expression{font-size:28px}
  .answer-btn{min-height:54px;font-size:28px!important;padding:12px 8px!important}
  .question-expression{font-size:36px!important}
  .end-action-btn{font-size:14px!important;padding:12px 16px!important}
}
